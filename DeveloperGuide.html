<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 1.5.6.1"><title>Budget Buddy - Developer Guide</title><link rel="stylesheet" href="stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="stylesheets/coderay-asciidoctor.css"></head><body class="article"><div id="site-header"><nav class="navbar navbar-light bg-light"><div class="container"><a class="navbar-brand" href="index.html">Budget Buddy</a><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="UserGuide.html">User Guide</a></li><li class="nav-item"><a class="nav-link active" href="DeveloperGuide.html">Developer Guide</a></li><li class="nav-item"><a class="nav-link" href="AboutUs.html">About Us</a></li><li class="nav-item"><a class="nav-link" href="ContactUs.html">Contact Us</a></li><li class="navitem"><a class="nav-link" href="https://github.com/AY1920S1-CS2103T-W13-4/main"><span class="fa fa-github fa-lg" aria-hidden="true"></span>&nbsp;View on GitHub</a></li></ul></div></nav></div><div id="header"><h1>Budget Buddy - Developer Guide</h1></div><div id="content"><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>By: <code>CS2103T W13-4</code></p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle"></div>
<ul class="sectlevel1">
<li><a href="#setting-up">1. Setting up</a></li>
<li><a href="#design">2. Design</a>
<ul class="sectlevel2">
<li><a href="#Design-Architecture">2.1. Architecture</a></li>
<li><a href="#Design-Ui">2.2. UI component</a></li>
<li><a href="#Design-Logic">2.3. Logic component</a></li>
<li><a href="#Design-Model">2.4. Model component</a></li>
<li><a href="#Design-Storage">2.5. Storage component</a></li>
<li><a href="#Design-Commons">2.6. Common classes</a></li>
</ul>
</li>
<li><a href="#implementation">3. Implementation</a>
<ul class="sectlevel2">
<li><a href="#accounts-feature">3.1. Accounts Feature</a></li>
<li><a href="#active-account">3.2. Active Account</a></li>
<li><a href="#transaction-model">3.3. Transaction Model</a></li>
<li><a href="#adding-transactions-code-txn-code">3.4. Adding Transactions: <code>txn</code></a></li>
<li><a href="#editing-transactions-code-txn-edit-code">3.5. Editing transactions: <code>txn edit</code></a></li>
<li><a href="#loans-feature">3.6. Loans Feature</a></li>
<li><a href="#rule-management-feature">3.7. Rule Management Feature</a></li>
<li><a href="#rule-execution-feature">3.8. Rule Execution Feature</a></li>
<li><a href="#scripting">3.9. Scripting</a></li>
<li><a href="#aliases">3.10. [Proposed] Aliases</a></li>
<li><a href="#logging">3.11. Logging</a></li>
<li><a href="#Implementation-Configuration">3.12. Configuration</a></li>
</ul>
</li>
<li><a href="#documentation">4. Documentation</a></li>
<li><a href="#testing">5. Testing</a></li>
<li><a href="#dev-ops">6. Dev Ops</a></li>
<li><a href="#product-scope">Appendix A: Product Scope</a></li>
<li><a href="#user-stories">Appendix B: User Stories</a></li>
<li><a href="#use-cases">Appendix C: Use Cases</a>
<ul class="sectlevel2">
<li><a href="#use-case-add-loan">C.1. Use case: Add loan</a></li>
<li><a href="#use-case-edit-loan">C.2. Use case: Edit loan</a></li>
<li><a href="#use-case-add-account">C.3. Use case: Add account</a></li>
<li><a href="#use-case-add-rule">C.4. Use case: Add rule</a></li>
</ul>
</li>
<li><a href="#non-functional-requirements">Appendix D: Non Functional Requirements</a></li>
<li><a href="#glossary">Appendix E: Glossary</a></li>
<li><a href="#instructions-for-manual-testing">Appendix F: Instructions for Manual Testing</a>
<ul class="sectlevel2">
<li><a href="#launch-and-shutdown">F.1. Launch and Shutdown</a></li>
<li><a href="#accounts">F.2. Accounts</a></li>
<li><a href="#loans">F.3. Loans</a></li>
<li><a href="#rules">F.4. Rules</a></li>
<li><a href="#scripts">F.5. Scripts</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="setting-up"><a class="link" href="#setting-up">1. Setting up</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Refer to the guide <a href="SettingUp.html">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="design"><a class="link" href="#design">2. Design</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="Design-Architecture"><a class="link" href="#Design-Architecture">2.1. Architecture</a></h3>
<div class="imageblock">
<div class="content">
<img src="images/ArchitectureDiagram.png" alt="ArchitectureDiagram" width="60%">
</div>
<div class="title">Figure 1. Architecture Diagram</div>
</div>
<div class="paragraph">
<p>The <strong><em>Architecture Diagram</em></strong> given above explains the high-level design of the App. Given below is a quick overview of each component.</p>
</div>
<div class="paragraph">
<p><code>Main</code> has two classes called <a href="https://github.com/AY1920S1-CS2103T-W13-4/main/src/main/java/budgetbuddy/Main.java"><code>Main</code></a> and <a href="https://github.com/AY1920S1-CS2103T-W13-4/main/src/main/java/budgetbuddy/MainApp.java"><code>MainApp</code></a>. It is responsible for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>At app launch, initialising the components in the correct sequence, and connecting them up with each other.</p>
</li>
<li>
<p>At shut down, shutting down the components and invoking cleanup methods where necessary.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#Design-Commons"><strong><code>Commons</code></strong></a> represents a collection of classes used by multiple other components.
The following class plays an important role at the architecture level:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LogsCenter</code> : Used by many classes to write log messages to the App&#8217;s log file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rest of the App consists of four components.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#Design-Ui"><strong><code>UI</code></strong></a>: The UI of the App.</p>
</li>
<li>
<p><a href="#Design-Logic"><strong><code>Logic</code></strong></a>: The command executor.</p>
</li>
<li>
<p><a href="#Design-Model"><strong><code>Model</code></strong></a>: Holds the data of the App in-memory.</p>
</li>
<li>
<p><a href="#Design-Storage"><strong><code>Storage</code></strong></a>: Reads data from, and writes data to, the hard disk.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of the four components</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Defines its <em>API</em> in an <code>interface</code> with the same name as the Component.</p>
</li>
<li>
<p>Exposes its functionality using a <code>{Component Name}Manager</code> class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the <code>Logic</code> component (see the class diagram given below) defines it&#8217;s API in the <code>Logic.java</code> interface and exposes its functionality using the <code>LogicManager.java</code> class.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/LogicClassDiagram.png" alt="LogicClassDiagram">
</div>
<div class="title">Figure 2. Class Diagram of the Logic Component</div>
</div>
<h4 id="how-the-architecture-components-interact-with-each-other" class="discrete">How the architecture components interact with each other</h4>
<div class="paragraph">
<p>The <em>Sequence Diagram</em> below shows how the components interact with each other
for the scenario where the user issues the command <code>account delete 1</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ArchitectureSequenceDiagram.png" alt="ArchitectureSequenceDiagram" width="85%">
</div>
<div class="title">Figure 3. Component interactions for <code>account delete 1</code> command</div>
</div>
<div class="paragraph">
<p>The sections below give more details of each component.</p>
</div>
</div>
<div class="sect2">
<h3 id="Design-Ui"><a class="link" href="#Design-Ui">2.2. UI component</a></h3>
<div class="imageblock">
<div class="content">
<img src="images/UiClassDiagram.png" alt="UiClassDiagram">
</div>
<div class="title">Figure 4. Structure of the UI Component</div>
</div>
<div class="paragraph">
<p><strong>API</strong> : <a href="https://github.com/AY1920S1-CS2103T-W13-4/main/src/main/java/budgetbuddy/ui/Ui.java"><code>Ui.java</code></a></p>
</div>
<div class="paragraph">
<p>The UI consists of a <code>MainWindow</code> that is made up of parts e.g.<code>CommandBox</code>, <code>ResultDisplay</code>, <code>ListPanel</code>, <code>StatusBarFooter</code> etc. All these, including the <code>MainWindow</code>, inherit from the abstract <code>UiPart</code> class.</p>
</div>
<div class="paragraph">
<p>The <code>UI</code> component uses JavaFx UI framework. The layout of these UI parts are defined in matching <code>.fxml</code> files that are in the <code>src/main/resources/view</code> folder. For example, the layout of the <a href="https://github.com/AY1920S1-CS2103T-W13-4/main/src/main/java/budgetbuddy/ui/MainWindow.java"><code>MainWindow</code></a> is specified in <a href="https://github.com/AY1920S1-CS2103T-W13-4/main/src/main/resources/view/MainWindow.fxml"><code>MainWindow.fxml</code></a></p>
</div>
<div class="paragraph">
<p>The <code>UI</code> component,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Executes user commands using the <code>Logic</code> component.</p>
</li>
<li>
<p>Listens for changes to <code>Model</code> data so that the UI can be updated with the modified data.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Design-Logic"><a class="link" href="#Design-Logic">2.3. Logic component</a></h3>
<div id="fig-LogicClassDiagram" class="imageblock">
<div class="content">
<img src="images/LogicClassDiagram.png" alt="LogicClassDiagram">
</div>
<div class="title">Figure 5. Structure of the Logic Component</div>
</div>
<div class="paragraph">
<p><strong>API</strong> :
<a href="https://github.com/AY1920S1-CS2103T-W13-4/main/src/main/java/budgetbuddy/logic/Logic.java"><code>Logic.java</code></a></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Logic</code> uses the <code>CommandLineParser</code> class to parse the user command.</p>
</li>
<li>
<p>This results in a <code>Command</code> object which is executed by the <code>LogicManager</code>.</p>
</li>
<li>
<p>The command execution can affect the <code>Model</code> (e.g. adding a loan).</p>
</li>
<li>
<p>The result of the command execution is encapsulated as a <code>CommandResult</code> object which is passed back to the <code>Ui</code>.</p>
</li>
<li>
<p>The <code>CommandResult</code> is used to display feedback to the user and update the current active tab based on its <code>CommandCategory</code>.</p>
</li>
<li>
<p>For certain commands (e.g. <code>help</code>, <code>script add</code>) the <code>CommandResult</code> will have a <code>CommandContinuation</code>
that will perform further actions or return a new <code>CommandResult</code> to evaluate again.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Given below is the Sequence Diagram for interactions within the <code>Logic</code> component for the <code>execute("account delete 1")</code> API call.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/DeleteSequenceDiagram.png" alt="DeleteSequenceDiagram">
</div>
<div class="title">Figure 6. Interactions Inside the Logic Component for the <code>account delete 1</code> Command</div>
</div>
</div>
<div class="sect2">
<h3 id="Design-Model"><a class="link" href="#Design-Model">2.4. Model component</a></h3>
<div class="imageblock">
<div class="content">
<img src="images/ModelClassDiagram.png" alt="ModelClassDiagram" width="80%">
</div>
<div class="title">Figure 7. Structure of the Model Component</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The lower levels of each <code>XYZManager</code> class can be viewed in their respective sections in the <a href="#implementation">Implementation</a> section.
For example, a more detailed class diagram of the <code>AccountsManager</code> can be found in <a href="#accounts-feature">Section 3.1.1</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>API</strong> : <a href="https://github.com/AY1920S1-CS2103T-W13-4/main/src/main/java/budgetbuddy/model/Model.java"><code>Model.java</code></a></p>
</div>
<div class="paragraph">
<p>The <code>Model</code>,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stores a <code>UserPref</code> object that represents the user&#8217;s preferences.</p>
</li>
<li>
<p>stores Budget Buddy&#8217;s data.</p>
</li>
<li>
<p>exposes multiple unmodifiable <code>ObservableList</code>s that can be 'observed' e.g. the different <code>DisplayPanel</code>s in UI are bound to these lists so that the UI automatically updates when the data in the lists change.</p>
</li>
<li>
<p>does not depend on any of the other three components.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Design-Storage"><a class="link" href="#Design-Storage">2.5. Storage component</a></h3>
<div class="imageblock">
<div class="content">
<img src="images/StorageClassDiagram.png" alt="StorageClassDiagram">
</div>
<div class="title">Figure 8. Structure of the Storage Component</div>
</div>
<div class="paragraph">
<p><strong>API</strong> : <a href="https://github.com/AY1920S1-CS2103T-W13-4/main/src/main/java/budgetbuddy/storage/Storage.java"><code>Storage.java</code></a></p>
</div>
<div class="paragraph">
<p>The <code>Storage</code> component</p>
</div>
<div class="ulist">
<ul>
<li>
<p>can save <code>UserPref</code> objects in JSON format and read it back.</p>
</li>
<li>
<p>can save Budget Buddy&#8217;s data in JSON format and read it back.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Budget Buddy saves its data in a few different JSON files,
namely <code>accounts.json</code>, <code>loans.json</code>, <code>rules.json</code> and <code>/scripts/descriptions.json</code>.
In addition, the user&#8217;s custom scripts are saved in the <code>/scripts/</code> folder.</p>
</div>
</div>
<div class="sect2">
<h3 id="Design-Commons"><a class="link" href="#Design-Commons">2.6. Common classes</a></h3>
<div class="paragraph">
<p>Classes used by multiple components are in the <code>budgetbuddy.commons</code> package.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementation"><a class="link" href="#implementation">3. Implementation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes some noteworthy details on how certain features are implemented.</p>
</div>
<div class="sect2">
<h3 id="accounts-feature"><a class="link" href="#accounts-feature">3.1. Accounts Feature</a></h3>
<div class="sect3">
<h4 id="implementation-2"><a class="link" href="#implementation-2">3.1.1. Implementation</a></h4>
<div class="paragraph">
<p>The Accounts Feature allows the users to manage their accounts.
It is managed by <code>AccountsManager</code>, with <code>Account</code> objects stored internally in an <code>accounts</code> and <code>filteredAccounts</code>.</p>
</div>
<div class="paragraph">
<p>The class diagram below shows how the <code>AccountsManager</code> manages its list of <code>Account</code> objects:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/accountclassdiagram.png" alt="accountclassdiagram">
</div>
</div>
<div class="paragraph">
<p>Each <code>Account</code> object has the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>name:Name</code>&#8201;&#8212;&#8201;The name of account created.</p>
</li>
<li>
<p><code>description:Description</code>&#8201;&#8212;&#8201;A description of the account to describe the use of the account.</p>
</li>
<li>
<p><code>transactionList:TransactionList</code>&#8201;&#8212;&#8201;The list of transactions associated with the account.</p>
</li>
<li>
<p><code>isActiveBooleanProperty:BooleanProperty</code>&#8201;&#8212;&#8201;The boolean property indicating whether an account is active or inactive.</p>
</li>
<li>
<p><code>balance:long</code>&#8201;&#8212;&#8201;The balance of the account, calculated by the net sum of expenses and income.</p>
</li>
<li>
<p><code>balanceLongProperty:LongProperty</code>&#8201;&#8212;&#8201;The Long property of the balance.</p>
</li>
<li>
<p><code>categoryset:Set&lt;Category&gt;</code>&#8201;&#8212;&#8201;The set of categories involved in the account.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To facilitate the manipulation of <code>Account</code> objects, <code>AccountsManager</code> implements the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AccountsManager#updateFilteredAccountList(Predicate&lt;Account&gt; predicate)</code>&#8201;&#8212;&#8201;Updates the predicate of <code>filteredAccounts</code>.</p>
</li>
<li>
<p><code>AccountsManager#getFilteredAccountList()</code>&#8201;&#8212;&#8201;Gets the list of <code>filteredAccounts</code> after applying its <code>predicate</code>.</p>
</li>
<li>
<p><code>AccountsManager#resetFilteredAccountList()</code>&#8201;&#8212;&#8201;Reset <code>filteredAccounts</code> so that all accounts present in <code>accounts</code> exist in <code>filteredAccounts</code>.</p>
</li>
<li>
<p><code>AccountsManager#getActiveTransactionList()</code>&#8201;&#8212;&#8201;Gets the <code>activeTransactionList</code> of the active account.</p>
</li>
<li>
<p><code>AccountsManager#getAccounts()</code>&#8201;&#8212;&#8201;Gets the list of <code>accounts</code>.</p>
</li>
<li>
<p><code>AccountsManager#size()</code>&#8201;&#8212;&#8201;Gets the size of the <code>accounts</code> list.</p>
</li>
<li>
<p><code>AccountsManager#addAccount(Account toAdd)</code>&#8201;&#8212;&#8201;Adds the <code>Account toAdd</code> to <code>accounts</code>.</p>
</li>
<li>
<p><code>AccountsManager#deleteAccount(Account toDelete)</code>&#8201;&#8212;&#8201;Deletes the account at <code>Index toDelete</code> from <code>accounts</code>.</p>
</li>
<li>
<p><code>AccountsManager#editAccount(Index toEdit, Account editedAccount)</code>&#8201;&#8212;&#8201;Edits the account at <code>Index Edit</code> to match <code>Account editedAccount</code>.</p>
</li>
<li>
<p><code>AccountsManager#switchActiveAccount(Index targetAccountIndex)</code>&#8201;&#8212;&#8201;Inactivate the current active account, and activate the target account.</p>
</li>
<li>
<p><code>AccountsManager#unsetActiveAccount()</code>&#8201;&#8212;&#8201;Inactivate any currently active account.</p>
</li>
<li>
<p><code>AccountsManager#setActiveAccount(Index toSet)</code>&#8201;&#8212;&#8201;Activate the target account.</p>
</li>
<li>
<p><code>AccountsManager#getAccount()</code>&#8201;&#8212;&#8201;Gets the target account.</p>
</li>
<li>
<p><code>AccountsManager#getActiveAccountIndex()</code>&#8201;&#8212;&#8201;Gets the index of the currently active account.</p>
</li>
<li>
<p><code>AccountsManager#getActiveAccount()</code>&#8201;&#8212;&#8201;Gets the currently active account.</p>
</li>
<li>
<p><code>AccountsManager#transactionListSwitchSource(Account account)</code>&#8201;&#8212;&#8201;Switches the account source for the TransactionList.</p>
</li>
<li>
<p><code>AccountsManager#transactionListUpdateSource()</code>&#8201;&#8212;&#8201;Updates the transactionList linked to the currentActiveAccount.</p>
</li>
<li>
<p><code>AccountsManager#exportReport()</code>&#8201;&#8212;&#8201;Exports the overview report of all accounts.
When the user inputs a command, several of the above operations are carried out.
For example, <code>account edit</code> will call <code>AccountsManager#resetFilteredAccountList</code> to update the <code>filteredAccounts</code>,
so that all accounts present in <code>accounts</code> will be present in <code>filteredAccounts</code>,
then <code>AccountsManager#editAccount</code> to edit the account,
finally <code>AccountsManager#getFilteredAccountList()</code> to display the list of accounts.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>After each command, the list of <code>accounts</code> is saved in <code>accounts.json</code>,
which is stored in a <code>data</code> folder in the same directory as <code>budgetbuddy.jar</code>.</p>
</div>
<div class="paragraph">
<p>Given below is an example usage scenario and how the <code>AccountsManager</code> behaves at each step.</p>
</div>
<div class="paragraph">
<p>Step 1. The user launches the application.
If this is the first time it is launched,
<code>accounts.json</code> is created and the <code>AccountsManager</code> initializes with an <code>accounts</code> containing a default account.
Otherwise, the data in <code>accounts.json</code> is loaded into <code>accounts</code>.</p>
</div>
<div class="paragraph">
<p>Step 2. The user executes <code>account add n/Japan trip d/expense spent in Japan</code> to add a new account.
This creates a new account <code>toAdd</code> with the <code>name</code> as Japan trip and <code>description</code> as expense spent in Japan.
<code>AccountsManager#addAccount(Account toAdd)</code> adds <code>toAdd</code> to <code>accounts</code>.
<code>filteredAccountList</code> will be automatically updated to match <code>accounts</code>.</p>
</div>
<div class="paragraph">
<p>Step 3. The user executes the command <code>account find trip</code> to find account contains the keyword trip specified.
<code>AccountsManager#updateFilteredAccountList</code> sets the predicate of <code>filteredAccounts</code> according to the input parameters.
Finally, <code>AccountsManager#getFilteredAccounts</code> retrieves an immutable version of <code>filteredAccounts</code> (filtered) to display to the user.
In this case, an account with the <code>name</code> as Japan trip and <code>description</code> as expense spent in Japan will be displayed.</p>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how finding the accounts containing specified keyword works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/AccountSequenceDiagram.png" alt="AccountSequenceDiagram">
</div>
</div>
<div class="paragraph">
<p>Most of the commands and operations behave in the same way.
The only difference will be the the action taken by the operation (e.g. finding account or adding account).</p>
</div>
<div class="paragraph">
<p>Step 4. The user executes <code>account delete 2</code> to delete the second account in the <code>accounts</code>.
Firstly, <code>AccountsManager#resetFilteredAccountList</code> will update the <code>filteredAccounts</code>,
so that all accounts present in <code>accounts</code> will be present in <code>filteredAccounts</code>,
then <code>AccountsManager#deleteAccount</code> deletes <code>toDelete</code> account from <code>accounts</code>.</p>
</div>
<div class="paragraph">
<p>Step 5. The user executes <code>account edit 3 n/food</code> to edit the <code>name</code> of the first account.
A new <code>editedAccount</code> is created, which is the same as the first third account except for its <code>name</code> which is food.
<code>AccountsManager#editAccount(Index toEdit, Account editedAccount</code> replaces the account at index <code>toEdit</code> with <code>editedAccount.</code></p>
</div>
<div class="paragraph">
<p>The activity diagram below shows what happens when the user executes <code>account edit</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/AccountActivityDiagram.png" alt="AccountActivityDiagram">
</div>
</div>
<div class="paragraph">
<p>Step 6. The user executes <code>account report 2</code> to view the details of the second account.
Firstly, <code>AccountsManager#resetFilteredAccountList</code> will update the <code>filteredAccounts</code>,
so that all accounts present in <code>accounts</code> will be present in <code>filteredAccounts</code>,
then <code>AccountsManager#getAccount</code> and <code>Account#getAccountInfo</code> are used to display the details of the second account.</p>
</div>
<div class="paragraph">
<p>Step 7. The user executes <code>account overview</code> to view the report of all accounts in an html export file.
Firstly, <code>AccountsManager#resetFilteredAccountList</code> will update the <code>filteredAccounts</code>,
so that all accounts present in <code>accounts</code> will be present in <code>filteredAccounts</code>,
then <code>AccountsManager#exportReport</code> generates the overview of all accounts html file to the exports folder.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For <code>account edit</code>, <code>account delete</code> and <code>account report</code>,
if the user targets an index beyond the last index,
an error message is displayed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations"><a class="link" href="#design-considerations">3.1.2. Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-interaction-with-ui-the-list-retrieved-by-code-logicmanager-code"><a class="link" href="#aspect-interaction-with-ui-the-list-retrieved-by-code-logicmanager-code">Aspect: Interaction with ui - the list retrieved by <code>LogicManager</code></a></h5>
<div class="paragraph">
<p>In the mainWindow of ui, <code>AccountTab</code> is associated with a list of accounts. However, two lists of accounts are required.
One stores all the current accounts present in <code>accounts</code>, the other one stores the <code>filteredAccounts</code> with the filtered accounts after <code>account find</code> executes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: <code>AccountTab</code> is only associated with <code>filteredAccounts</code> as <code>filteredAccounts</code> stores all accounts.
After each command, <code>AccountsManager#resetFilteredAccountList</code> is called to reset the predicate to be true, so that <code>filteredAccounts</code> matches <code>accounts</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Only one list of accounts is associated with <code>LogicManager</code>.</p>
</li>
<li>
<p>Cons: It is counter-intuitive as <code>filteredAccounts</code> is supposed to stored the accounts that have been selected.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong>: <code>AccountListPanel</code> is associated with both <code>filteredAccounts</code> and <code>accounts</code>, and the display of the list switches when necessary.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to understand and align with the common sense.</p>
</li>
<li>
<p>Cons: Hard to implement.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="active-account"><a class="link" href="#active-account">3.2. Active Account</a></h3>
<div class="sect3">
<h4 id="implementation-3"><a class="link" href="#implementation-3">3.2.1. Implementation</a></h4>
<div class="paragraph">
<p>The active <code>Account</code> allows operations on <code>Transaction</code> objects to not have to specify the concerning <code>Account</code> when
the command is entered. This allows for a more user-friendly and intuitive experience with managing finances. By updating
<code>ActiveAccountIndex</code> where appropriate, the <code>activeAccount</code> is implemented on the idea that users want to continue to
manipulate transactions within the same <code>Account</code> that they last interacted with.</p>
</div>
<div class="paragraph">
<p>The current active <code>Account</code> is indicated in the UI by a highlight as shown below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ActiveAccount1.png" alt="ActiveAccount1">
</div>
<div class="title">Figure 9. Screenshot of the UI showing the highlighted active Account.</div>
</div>
<div class="paragraph">
<p>The following user commands, if executed successfully, can change the active account:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AccountAddCommand</code>&#8201;&#8212;&#8201;The added <code>Account</code> becomes the active account.</p>
</li>
<li>
<p><code>AccountDeleteCommand</code>&#8201;&#8212;&#8201;If the active <code>Account</code> is deleted, a new active <code>Account</code> will be selected.</p>
</li>
<li>
<p><code>AccountEditCommand</code>&#8201;&#8212;&#8201;The edited <code>Account</code> becomes the active account.</p>
</li>
<li>
<p><code>AccountFindCommand</code>&#8201;&#8212;&#8201;The first <code>Account</code> in the list is set as the active <code>Account</code>.</p>
</li>
<li>
<p><code>AccountListCommand</code>&#8201;&#8212;&#8201;The first <code>Account</code> in the list is set as the active <code>Account</code>.</p>
</li>
<li>
<p><code>AccountReportCommand</code>&#8201;&#8212;&#8201;The target <code>Account</code> is set as the new active <code>Account</code>.</p>
</li>
<li>
<p><code>AccountSwitchCommand</code>&#8201;&#8212;&#8201;The target <code>Account</code> is set as the new active <code>Account</code>.</p>
</li>
<li>
<p><code>TransactionAddCommand</code>&#8201;&#8212;&#8201;The target <code>Account</code> is set as the new active <code>Account</code>.</p>
</li>
<li>
<p><code>TransactionEditCommand</code>&#8201;&#8212;&#8201;The target <code>Account</code> is set as the new active <code>Account</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-2"><a class="link" href="#design-considerations-2">3.2.2. Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-responsive-ui-for-showing-the-active-code-account-code"><a class="link" href="#aspect-responsive-ui-for-showing-the-active-code-account-code">Aspect: responsive UI for showing the active <code>Account</code></a></h5>
<div class="paragraph">
<p>An <code>Extractor</code> is used to update the UI when an <code>Account</code> is set as active, or when the <code>balance</code> is updated. This is because
the <code>FilteredList&lt;Account&gt;</code> only updates automatically when the Accounts themselves are changed, but not when their internal
elements are altered.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: Use an <code>Extractor</code> to listen for changes to <code>isActiveBooleanProperty</code> and <code>balanceLongProperty</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Less overhead/unnecessary movement of accounts</p>
</li>
<li>
<p>Cons: Not as easy for new developers to understand and implement.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong>: Refresh the account list by forcing removal and re-addition of each of the accounts.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to implement, no need to change members to adapt to the <code>Property</code> class, and easier for newer developers to read and understand.</p>
</li>
<li>
<p>Cons: High overhead, as more and more accounts are added to the BudgetBuddy.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="transaction-model"><a class="link" href="#transaction-model">3.3. Transaction Model</a></h3>
<div class="sect3">
<h4 id="implementation-4"><a class="link" href="#implementation-4">3.3.1. Implementation</a></h4>
<div class="paragraph">
<p>Transactions are the main elements of the BudgetBuddy&#8217;s expenses tracker. Within each <code>Account</code>, a <code>TransactionList</code> is
stored, and inside each <code>TransactionList</code>, <code>Transaction</code> objects are stored internally in the <code>internalList</code> of the
<code>TransactionList</code>.</p>
</div>
<div class="paragraph">
<p>The class diagram below shows how <code>Transaction</code> objects are stored within an <code>Account</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/TransactionClassDiagram.png" alt="TransactionClassDiagram">
</div>
<div class="title">Figure 10. Class Diagram of the Transactions Model</div>
</div>
<div class="paragraph">
<p>Each <code>Transaction</code> object must have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>direction: Direction</code>&#8201;&#8212;&#8201;The direction of the transaction (either <code>IN</code> for money inflow or <code>OUT</code> for money outflow).</p>
</li>
<li>
<p><code>amount: Amount</code>&#8201;&#8212;&#8201;The amount of money transacted.</p>
</li>
<li>
<p><code>date: LocalDate</code>&#8201;&#8212;&#8201;The date of the transaction.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optional attributes for <code>Transaction</code> objects:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>description: Description</code>&#8201;&#8212;&#8201;A short description about the transaction.</p>
</li>
<li>
<p><code>categories: Set&lt;Category&gt;</code>&#8201;&#8212;&#8201;A <code>Set</code> of <code>Category</code> objects that categorize the transaction.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Because <code>Transaction</code> and <code>TransactionList</code> objects are contained within <code>Account</code> objects, which are in turn stored within the
<code>AccountsManager</code>, it is called when any operations is made on a <code>Transaction</code>. Additionally, <code>AccountsManager</code> has an
<code>activeTransactionList</code> which holds the <code>TransactionList</code> of the current active <code>Account</code>. <code>activeTransactionList</code> is then
wrapped by a <code>SortedList</code> and <code>FilteredList</code> to enable the sorting and filtering of the <code>Transaction</code> objects.</p>
</div>
<div class="paragraph">
<p>These methods in <code>AccountsManager</code> below that manipulate the <code>activeTransactionList</code> are called when the list of
transactions needs to be filtered/sorted:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AccountsManager#getFilteredTransactionList()</code>&#8201;&#8212;&#8201;Returns an <code>ObservableList</code> of the filtered transactions.</p>
</li>
<li>
<p><code>AccountsManager#updateFilteredTransactionList(Predicate&lt;Transaction&gt; predicate)</code>&#8201;&#8212;&#8201;Updates the <code>Predicate&lt;Transaction&gt;</code> of the <code>FilteredList</code> to filter by the given <code>Predicate&lt;Transaction&gt;</code></p>
</li>
<li>
<p><code>AccountsManager#resetFilteredTransactionList()</code>&#8201;&#8212;&#8201;Resets and removes any filter on the <code>FilteredList</code>.</p>
</li>
<li>
<p><code>AccountsManager#updateSortedTransactionList(Comparator&lt;Transaction&gt; comparator)</code>&#8201;&#8212;&#8201;Updates the <code>Comparator&lt;Transaction&gt;</code> of the <code>SortedList</code> to sort by the given <code>Comparator&lt;Transaction&gt;</code></p>
</li>
<li>
<p><code>AccountsManager#resetSortedTransactionList()</code>&#8201;&#8212;&#8201;Resets the <code>Comparator</code> on the <code>FilteredList</code> to the default comparator.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When <code>Transaction</code> objects are added/edited/deleted, the following implemented methods are called from <code>Account</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Account#addTransaction(Transaction toAdd)</code>&#8201;&#8212;&#8201;Adds a <code>Transaction</code> to the <code>transactionList</code>.</p>
</li>
<li>
<p><code>Account#updateTransaction(Index txnIndex, Transaction editedTxn)</code>&#8201;&#8212;&#8201;Sets a <code>Transaction</code> to the <code>transactionList</code> at the specified <code>Index</code>.</p>
</li>
<li>
<p><code>Account#deleteTransaction(Transaction toDelete)</code>&#8201;&#8212;&#8201;Deletes a <code>Transaction</code> from the <code>transactionList</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>Transaction</code> objects are saved within their respective <code>Account</code> objects after every command, and they are saved
into the file <code>accounts.json</code>, stored in the same directory as the JAR executable.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-3"><a class="link" href="#design-considerations-3">3.3.2. Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-reference-to-respective-account-in-transaction"><a class="link" href="#aspect-reference-to-respective-account-in-transaction">Aspect: Reference to respective Account in Transaction</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: <code>Transaction</code> has no reference to <code>Account</code>; any commands that create/edit/delete <code>Transaction</code> objects
are called via the active <code>Account</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Reduced coupling, which makes testing/maintenance easier.</p>
</li>
<li>
<p>Cons: More methods are required to ensure the logic of <code>Transaction</code> commands and the current active <code>Account</code>,
instead of calling getAccount() on a <code>Transaction</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong>: <code>Transaction</code> holds a reference to <code>Account</code>; commands that create/edit/delete <code>Transaction</code> objects
directly reach the <code>Account</code> through the <code>Transaction</code>.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: It would result in shorter code by avoiding having to go through <code>AccountsManager</code> to find the respective <code>Account</code>.</p>
</li>
<li>
<p>Cons: This would result in a circular dependency between <code>Transaction</code> and <code>Account</code>, as well as high coupling.
This lowers testability and increases the risk of bugs.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-transactions-code-txn-code"><a class="link" href="#adding-transactions-code-txn-code">3.4. Adding Transactions: <code>txn</code></a></h3>
<div class="paragraph">
<p>Given below is an example usage scenario and how the <code>txn</code> command is processed and executed at each step.</p>
</div>
<div class="paragraph">
<p>Step 1: The user (ideally an NUS Computing Student) executes <code>txn dn/out x/50 d/books a/school</code> to add a purchase of $50 worth of
books, to be added to the <code>school</code> <code>Account</code>.</p>
</div>
<div class="paragraph">
<p>Step 2: <code>LogicManager</code> calls <code>parseCommand</code> on the command string <code>txn dn/out x/50 d/books a/school</code></p>
</div>
<div class="paragraph">
<p>Step 3: <code>CommandLineParser</code> creates a new <code>TransactionAddCommandParser</code> by identifying the <code>txn</code> String that represents a
<code>TransactionAddCommand</code></p>
</div>
<div class="paragraph">
<p>Step 4: <code>TransactionAddCommandParser</code> parses the rest of the command string <code>dn/out x/50 d/books a/school</code> and return a
new <code>TransactionAddCommand</code> with the parsed details.</p>
</div>
<div class="paragraph">
<p>Step 5: <code>LogicManager</code> then calls <code>execute()</code> on the <code>TransactionAddCommand</code>, which gets the <code>Account</code> <code>school</code> from the
<code>AccountsManager</code></p>
</div>
<div class="paragraph">
<p>Step 6: <code>addTransaction</code> is called on the returned <code>Account</code> to add the <code>Transaction</code> to the <code>TransactionList</code> of
the Account`.</p>
</div>
<div class="paragraph">
<p>Step 7: After adding the <code>Transaction</code>, RuleEngine is called to execute its rules over the newly added <code>Transaction</code>.
The full diagram sequence diagram for this step can be found <a href="#rule-execution-sequence-diagram">below</a>, in the Implementation of the Rules Execution feature.</p>
</div>
<div class="paragraph">
<p>Step 8: The <code>Account</code> which was added to is set as the active <code>Account</code> with <code>setActiveAccount()</code>.</p>
</div>
<div class="paragraph">
<p>Step 9: Finally, <code>TransactionAddCommand</code> returns a <code>CommandResult</code> to the <code>LogicManager</code>.</p>
</div>
<div class="paragraph">
<p>Step 10: Before <code>LogicManager</code> returns the <code>CommandResult</code>, it calls <code>save(Model model)</code> on the <code>StorageManager</code>, which
saves all the <code>Account</code> objects.</p>
</div>
<div class="paragraph">
<p>The following sequence diagram illustrates the scenario as described above (the execution of <code>txn dn/out x/50 d/books a/school</code>):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/TransactionSequenceDiagram.png" alt="TransactionSequenceDiagram">
</div>
<div class="title">Figure 11. Sequence Diagram of the TransactionAddCommand</div>
</div>
</div>
<div class="sect2">
<h3 id="editing-transactions-code-txn-edit-code"><a class="link" href="#editing-transactions-code-txn-edit-code">3.5. Editing transactions: <code>txn edit</code></a></h3>
<div class="paragraph">
<p><code>txn edit</code> allows users to edit any attribute of the <code>Transaction</code>. It uses a <code>TransactionEditDescriptor</code> to store the details
of the new <code>Transaction</code>, then uses <code>getUpdatedTransaction</code> to generate the edited <code>Transaction</code> as well as validate that
changes have been made to the transaction.</p>
</div>
<div class="paragraph">
<p>Below is an example scenario to demonstrate how a <code>Transaction</code> is edited, as well as certain additional steps that are taken when certain
attributes of the <code>Transaction</code> are edited, for example to edit the <code>Account</code> or to edit the <code>categories</code>. The activity diagram
accompanies this explanation, to help visualise the steps that might take place.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/TransactionActivityDiagram.png" alt="TransactionActivityDiagram">
</div>
<div class="title">Figure 12. Activity Diagram of the execution of a TransactionEditCommand</div>
</div>
<div class="paragraph">
<p>Assume that <code>txn add dn/out x/20 d/bill a/home</code> was just executed, and that the <code>Transaction</code> shows up in the first index:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/TransactionEdit1.png" alt="TransactionEdit1">
</div>
<div class="title">Figure 13. Screenshot of previously added transaction</div>
</div>
<div class="paragraph">
<p>Step 1: The user (ideally an NUS Computing Student) executes <code>txn edit 1 x/28 d/phone bill a/personal c/phone c/bill</code>
to edit the previously added <code>Transaction</code> to a $28 phone bill, to be added to the <code>personal</code> <code>Account</code>.</p>
</div>
<div class="paragraph">
<p>Step 2: <code>LogicManager</code> calls <code>parseCommand</code> on the command string <code>txn edit 1 x/28 d/phone bill a/personal c/phone c/bill</code></p>
</div>
<div class="paragraph">
<p>Step 3: <code>CommandLineParser</code> creates a new <code>TransactionEditCommandParser</code> by identifying the <code>txn edit</code> String that represents a
<code>TransactionAddCommand</code></p>
</div>
<div class="paragraph">
<p>Step 4: <code>TransactionAddCommandParser</code> parses the rest of the command string <code>1 x/28 d/phone bill a/personal c/phone c/bill</code> and return a
new <code>TransactionEditCommand</code> along with the <code>TransactionEditDescriptor</code> and the <code>updatedAccountName</code>, which represents the
<code>Name</code> of the new target <code>Account</code>. A new <code>Set&lt;Categories&gt;</code> is also created from the <code>c/phone</code> and <code>c/bill</code> arguments provided.</p>
</div>
<div class="paragraph">
<p>Step 5: <code>LogicManager</code> then calls <code>execute()</code> on the <code>TransactionEditCommand</code>. Then, the original <code>Transaction</code> is obtained,
followed by the target <code>Account</code> and the edited <code>Transaction</code> via <code>getUpdatedTransaction</code>. Meanwhile, validation occurs
at every step, to ensure that the parsed attributes conform to the requirements to edit the `Transaction.</p>
</div>
<div class="paragraph">
<p>Step 6: <code>deleteTransaction</code> is called on the <code>Account</code> containing the <code>Transaction</code> to be edited.</p>
</div>
<div class="paragraph">
<p>Step 7: <code>addTransaction</code> is called on the target <code>Account</code>, followed by the execution of the RulesEngine, similar to the
situation as shown <a href="#rule-execution-sequence-diagram">further below</a>.</p>
</div>
<div class="paragraph">
<p>Step 8: The <code>Account</code> which was added to is set as the active <code>Account</code> with <code>setActiveAccount()</code>.</p>
</div>
<div class="paragraph">
<p>Step 9: Finally, <code>TransactionAddCommand</code> returns a <code>CommandResult</code> to the <code>LogicManager</code>.</p>
</div>
<div class="paragraph">
<p>Step 10: Before <code>LogicManager</code> returns the <code>CommandResult</code>, it calls <code>save(Model model)</code> on the <code>StorageManager</code>, which
saves all the <code>Account</code> objects.</p>
</div>
</div>
<div class="sect2">
<h3 id="loans-feature"><a class="link" href="#loans-feature">3.6. Loans Feature</a></h3>
<div class="sect3">
<h4 id="implementation-5"><a class="link" href="#implementation-5">3.6.1. Implementation</a></h4>
<div class="paragraph">
<p>The Loans feature exists outside of the Account/Transaction mechanisms.
It adds a separate <code>LoansManager</code> alongside the main <code>AccountsManager</code>, with <code>Loan</code> objects stored internally in an <code>internalList</code>.</p>
</div>
<div class="paragraph">
<p>The following class diagram demonstrates the association between the <code>LoansManager</code> and <code>Loan</code> objects.
Miscellaneous methods (such as <code>LoansManager#getLoans</code> and <code>LoansManager#getLoansCount</code>) are omitted.</p>
</div>
<div id="loan-class-diagram" class="imageblock">
<div class="content">
<img src="images/LoanClassDiagram.png" alt="LoanClassDiagram">
</div>
<div class="title">Figure 14. Class Diagram of the Loans Model</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>Debtor</code> class, <code>LoansManager#debtors</code>, <code>LoansManager#setDebtors</code> and <code>LoansManager#getDebtors</code> can be ignored for now.
They are depicted here for the sake of completion,
but will only be used when discussing the <code>loan split</code> command in a <a href="#loan-splitting">later section</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each <code>Loan</code> object has the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>person:Person</code>&#8201;&#8212;&#8201;The person that the user lent/borrowed money to/from.</p>
</li>
<li>
<p><code>amount:Amount</code>&#8201;&#8212;&#8201;The amount of money loaned.</p>
</li>
<li>
<p><code>direction:Direction</code>&#8201;&#8212;&#8201;The direction of the loan (either <code>IN</code> or <code>OUT</code>).</p>
</li>
<li>
<p><code>status:Status</code>&#8201;&#8212;&#8201;The status of the loan (either <code>PAID</code> or <code>UNPAID</code>).</p>
</li>
<li>
<p><code>date:LocalDate</code>&#8201;&#8212;&#8201;The date of the loan.</p>
</li>
<li>
<p><code>description:Description</code>&#8201;&#8212;&#8201;A description of the loan.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To facilitate the manipulation of <code>Loan</code> objects, <code>LoansManager</code> implements the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LoansManager#updateFilteredList(Predicate&lt;Loan&gt; predicate)</code>&#8201;&#8212;&#8201;Updates the current predicate of <code>filteredLoans</code> to <code>predicate</code>.</p>
</li>
<li>
<p><code>LoansManager#sortLoans(Comparator&lt;Loan&gt; sorter)</code>&#8201;&#8212;&#8201;Sorts <code>internalList</code> using the given <code>sorter</code>.</p>
</li>
<li>
<p><code>LoansManager#getFilteredLoans()</code>&#8201;&#8212;&#8201;Gets <code>filteredLoans</code>, representing the loans in <code>internalList</code> after filtering.</p>
</li>
<li>
<p><code>LoansManager#addLoan(Loan toAdd)</code>&#8201;&#8212;&#8201;Adds the <code>Loan toAdd</code> to <code>internalList</code>.</p>
</li>
<li>
<p><code>LoansManager#editLoan(Index toEdit, Loan editedLoan)</code>&#8201;&#8212;&#8201;Replaces the loan at <code>Index toEdit</code> with <code>Loan editedLoan</code>.</p>
</li>
<li>
<p><code>LoansManager#updateStatus(Index toUpdate, Loan updatedLoan)</code>&#8201;&#8212;&#8201;Replace the loan at <code>Index toUpdate</code> with <code>Loan updatedLoan</code>.</p>
</li>
<li>
<p><code>LoansManager#deleteLoan(Index toDelete)</code>&#8201;&#8212;&#8201;Deletes the loan at <code>Index toDelete</code> from <code>internalList</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each user-given command will call at least one of the above operations.
For example, <code>loan delete</code> will call <code>LoansManager#deleteLoan</code> to delete the targeted loan(s),
then <code>LoansManager#getFilteredLoans</code> to display the remaining loans.</p>
</div>
<div class="paragraph">
<p>After each command, the state of <code>internalList</code> is saved in the file <code>loans.json</code>.
<code>loans.json</code> is stored on the local hard disk in a <code>data</code> folder,
which is in the same directory as <code>budgetbuddy.jar</code>.</p>
</div>
<div class="paragraph">
<p>Given below is an example usage scenario and how the <code>LoansManager</code> behaves at each step.</p>
</div>
<div class="paragraph">
<p>Step 1.
The user launches the application.
If <code>loans.json</code> exists on the hard disk, its data is loaded into <code>internalList</code>.
Otherwise, <code>loans.json</code> is created and the <code>LoansManager</code> initializes with an <code>internalList</code> containing a few sample loans.</p>
</div>
<div class="paragraph">
<p>Step 2.
The user executes the command <code>loan out p/John x/4.20 d/Paid for his lunch</code> to add a new loan.
This creates a new loan <code>toAdd</code> of <code>amount</code> 4.20 <code>out</code> to the <code>person</code> John, with the description <code>Paid for his lunch</code>.
Since the user did not provide a date, the current system date is used for the <code>date</code> of <code>toAdd</code>.
<code>LoansManager#addLoan(Loan toAdd)</code> is called and
(after verifying that <code>toAdd</code> does not already exist in <code>internalList</code>)
<code>toAdd</code> is added to <code>internalList</code>.</p>
</div>
<div class="paragraph">
<p>The following sequence diagram illustrates the process of adding a loan:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/LoanSequenceDiagram.png" alt="LoanSequenceDiagram">
</div>
<div class="title">Figure 15. Sequence Diagram for Adding a Loan</div>
</div>
<div class="paragraph">
<p>In general, the rest of the operations work using a similar sequence of steps.
Some commands might create a new <code>Loan</code> object (as shown above) while others might just use the <code>Index</code> of a loan (e.g. <code>loan delete</code>).</p>
</div>
<div class="paragraph">
<p>Step 3.
The user executes the command <code>loan list out p/John w/1/11/2019 s/x</code>
to see all loans <code>out</code> to <code>John</code> dated <code>1/11/2019</code>, sorted by amount.
First, <code>LoansManager#sortLoans</code> is called to sort the loans in <code>internalList</code> by their amounts in ascending order.
<code>LoansManager#updateFilteredList</code> is then called to set the predicate of <code>filteredLoans</code>;
the new predicate filters the list to loans <code>out</code> to the person <code>John</code> on <code>1/11/2019</code>.
Finally, <code>LoansManager#getFilteredLoans</code> is called to display the (sorted and filtered) list to the user.</p>
</div>
<div class="paragraph">
<p>Step 4.
The user executes the command <code>loan paid 1</code> to update the status of the first loan in the list to <code>PAID</code>.
This creates a new <code>updatedLoan</code> identical to the first loan in <code>internalList</code>, except that <code>updatedLoan</code> has the status <code>PAID</code>.
<code>LoansManager#updateStatus(Index toUpdate, Loan updatedLoan)</code> is called
(where <code>toUpdate</code> is the index of the first loan in <code>internalList</code>)
and the loan at index <code>toUpdate</code> is replaced with <code>updatedLoan</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The command <code>loan unpaid</code> works identically to <code>loan paid</code>, except that the <code>status</code> of <code>updatedLoan</code> is set to <code>UNPAID</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Step 5.
The user executes the command <code>loan edit 1 x/500</code> to edit the <code>amount</code> of the first loan in the list to <code>500</code>.
<code>LoansManager#editLoan(Index toEdit, Loan editedLoan)</code> is called
and the loan at index <code>toEdit</code> is replaced with an <code>editedLoan</code> that has an <code>amount</code> of <code>500</code>.
While this operation appears identical to <code>LoansManager#updateStatus</code>,
<code>LoansManager#editLoan</code> implements an extra check to ensure that <code>editedLoan</code> does not already exist in <code>internalList</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>LoansManager#updateStatus</code> does not implement the check for a duplicate loan
as the <code>status</code> of a <code>Loan</code> is not considered when comparing two loans for equality.
<code>internalList</code> is already guaranteed to have no identical loans due to the checks in
<code>LoansManager#addLoan</code> and <code>LoansManager#editLoan</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Step 6.
The user executes the command <code>loan delete 1</code> to delete the first loan in the list.
<code>LoansManager#deleteLoan(Index toDelete)</code> is called
(where <code>toDelete</code> is the index of the first loan in <code>internalList</code>)
and the loan at index <code>toDelete</code> is removed from <code>internalList</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For the commands <code>loan paid</code>, <code>loan unpaid</code> and <code>loan delete</code>,
if the user targets a loan outside of the list (e.g. index greater than list size)
an error message will be displayed.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="multi-loan-targeting"><a class="link" href="#multi-loan-targeting">Multi-Loan Targeting</a></h5>
<div class="paragraph">
<p>The user can target and act on multiple loans with a single command.
For example, <code>loan paid 1 3 4</code> can be used to mark the first, third and fourth loans in <code>internalList</code> as <code>PAID</code>.
Alternatively or additionally, <code>loan paid p/John p/Mary</code> can also be used
to mark all the loans of the persons John and Mary in <code>internalList</code>.
The <code>LoansManager</code> handles this by executing the appropriate operation repeatedly.
In the case of <code>loan paid 1 3 4</code>, <code>LoansManager#editLoan</code> is called once for each of the three loans.</p>
</div>
<div class="paragraph">
<p>To account for the fact that the list size might change after each operation,
the size of the list before and after each operation is compared.
If it has changed, the targeted indices are adjusted accordingly.</p>
</div>
<div class="paragraph">
<p>If any of the target loan indices cannot be found by the <code>LoansManager</code> in <code>internalList</code>,
they are added to a <code>missingLoanIndices</code> list.
Similarly, target persons that cannot be found are added to a <code>missingPersons</code> list.
Both lists are displayed to the user after other target loans that are in <code>internalList</code> have been acted upon,
notifying the user that the target <code>indices</code>/<code>persons</code> could not be found.</p>
</div>
<div class="paragraph">
<p>Multi-loan targeting is implemented for the commands <code>loan paid</code>, <code>loan unpaid</code> and <code>loan delete</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="loan-splitting"><a class="link" href="#loan-splitting">Loan Splitting</a></h5>
<div class="paragraph">
<p>Loan splitting exists as a command that the user can execute.
Its purpose is to split a large, initially unbalanced group payment equally among the group&#8217;s members.
The following example scenario should clarify the purpose of the command:</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>John, Mary and Peter go out for dinner.
The meal costs $100, so Peter pays $90 and Mary covers the remaining $10.
However, the three want to split the bill equally among themselves.</p>
</div>
<div class="paragraph">
<p>John executes the command <code>loan split p/John p/Mary p/Peter x/0 x/10 x/90</code>.
Budget Buddy then outputs a list of the necessary payments between the three.
From this list, John can now see that he owes Peter <strong>$33.33</strong> and that Mary owes Peter <strong>$23.33</strong>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>To display the results of the calculations, <code>LoansManager</code> holds a list of <code>debtors</code> containing <code>Debtor</code> objects.
For your convenience, the <a href="#loan-class-diagram">class diagram of the Loans model</a> is reproduced here:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/LoanClassDiagram.png" alt="LoanClassDiagram">
</div>
<div class="title">Figure 16. Reproduction of Class Diagram of the Loans Model</div>
</div>
<div class="paragraph">
<p>Each <code>Debtor</code> object has the following attributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>debtor:Person</code>&#8201;&#8212;&#8201;The person who owes money to one or more creditors.</p>
</li>
<li>
<p><code>creditors:HashMap&lt;Person, Amount&gt;</code>&#8201;&#8212;&#8201;A list of persons that the <code>debtor</code> owes money to, mapped to the amount of money owed.
Each entry in the <code>HashMap</code> represents a creditor, with their name as the <code>Person</code> key and the amount owed as the corresponding <code>Amount</code> value.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>LoansManager</code> also implements the <code>getDebtors</code> and <code>setDebtors</code> operations to manipulate the <code>debtors</code> list.
This list is used to hold and display the <code>Debtor</code> objects created for the latest execution of <code>loan split</code>
and is stored between sessions in <code>loans.json</code>.</p>
</div>
<div class="paragraph">
<p>Given below is an example scenario to demonstrate how the final list is calculated.
The algorithm as a whole can be summarized in the activity diagram below,
which might prove helpful for following the steps in the example scenario:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/LoanSplitActivityDiagram.png" alt="LoanSplitActivityDiagram">
</div>
<div class="title">Figure 17. Activity Diagram for Loan Split Algorithm</div>
</div>
<div class="paragraph">
<p>Step 1.
The user executes the command <code>loan split p/Ben p/Duke p/Adam p/Zed x/0 x/20 x/80 x/50 max/10 me/Ben d/Dinner</code>.
In this scenario, out of the total bill of <strong>$150</strong>,
<code>Ben</code> has paid <strong>$0</strong>,
<code>Duke</code> has paid <strong>$20</strong>,
<code>Adam</code> has paid <strong>$80</strong>
and <code>Zed</code> has paid <strong>$50</strong>.
Furthermore, <code>max/10</code> specifies that <code>Ben</code> should only pay/owe up to <strong>$10</strong> overall.
Finally, <code>me/Ben</code> marks <code>Ben</code> as the user;
all debts involving <code>Ben</code> should be added to the normal loan list with the description <code>Dinner</code>.</p>
</div>
<div class="paragraph">
<p>Step 2.
<code>LoanSplitCommandParser</code> parses the persons, amounts, and max shares into <code>List&lt;Person&gt;</code>, <code>List&lt;Amount&gt;</code> and <code>List&lt;Long&gt;</code> respectively.
<code>me/Ben</code> and <code>d/Dinner</code> are parsed into <code>Optional&lt;Person&gt;</code> and <code>Optional&lt;Description&gt;</code>.
A new <code>LoanSplitCommand</code> is instantiated with the lists and optional objects.</p>
</div>
<div class="paragraph">
<p>Step 3.
<code>LoanSplitCommand</code> replaces <code>Ben</code> in <code>List&lt;Person&gt;</code> with a <code>Person</code> with the <code>Name</code> <code>You</code>.
Using the static methods of a <code>LoanSplitCalculator</code> class, it then begins executing the following algorithm:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The <code>defaultSharePerPerson</code> is calculated.
In this scenario, <strong>$150</strong> should be split among the 4 persons.
However, as <code>Ben</code> has a max share of <strong>$10</strong>, the other 3 persons must divide <strong>$140</strong> among themselves,
resulting in a <code>defaultSharePerPerson</code> of <strong>$46.66</strong>.</p>
</li>
<li>
<p>Each person in <code>List&lt;Person&gt;</code> is given a <code>balance</code>,
calculated using the amount they paid initially (from <code>List&lt;Amount&gt;</code>)
minus either the <code>defaultSharePerPerson</code> or their max share if present.</p>
</li>
<li>
<p>A list of all possible sub-groups (combinations) of persons is generated.
In this scenario, the number of sub-groups for the 4 persons would be <strong>16</strong>.</p>
</li>
<li>
<p>For each sub-group, if the sum of their balances is <strong>zero</strong>, then the following steps are performed:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Take the persons with the smallest and biggest balances: the <code>debtor</code> and <code>creditor</code> respectively.</p>
</li>
<li>
<p>Transfer money between the two such that one or both of their balances reaches zero.
The person(s) with a balance of zero are then removed from the group,
and a record of the <code>debtor</code>, <code>creditor</code> and <code>amountTransferred</code> is stored in a <code>List&lt;DebtorCreditorAmount&gt;</code>.</p>
</li>
<li>
<p>Repeat until the sub-group contains less than two persons.</p>
</li>
</ol>
</div>
</li>
<li>
<p>After every sub-group has been processed, <code>List&lt;DebtorCreditorAmount&gt;</code> is used to create the final <code>List&lt;Debtor&gt;</code> stored in <code>LoansManager</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Step 4.
All debts involving the person <code>You</code> in <code>List&lt;Person&gt;</code>
are used to create loans with the description <code>Dinner</code>.
These loans are added to <code>internalList</code> in <code>LoansManager</code> using <code>LoansManager#addLoan</code>.</p>
</div>
<div class="paragraph">
<p>Step 5. The list of <code>debtors</code> in <code>LoansManager</code> is displayed to the user.
In this scenario, the display will show that
<code>Duke</code> owes <code>Adam</code> <strong>$26.66</strong>
and <code>You</code> (<code>Ben</code>, the user) owe <code>Zed</code> and <code>Adam</code> <strong>$3.32</strong> and <strong>$6.68</strong> respectively.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-4"><a class="link" href="#design-considerations-4">3.6.2. Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-structure-of-the-loan-person-interaction"><a class="link" href="#aspect-structure-of-the-loan-person-interaction">Aspect: Structure of the loan - person interaction</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: <code>LoansManager</code> stores <code>internalList</code>; each <code>Loan</code> references a <code>Person</code></p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to implement and understand.</p>
</li>
<li>
<p>Cons: Takes a longer time to get all the loans belonging to a person.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong>: <code>LoansManager</code> stores <code>persons</code> list; each <code>Person</code> stores <code>LoanList</code>; each <code>Loan</code> references <code>Person</code></p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to retrieve the person of each loan and retrieve all the loans belonging to a person.</p>
</li>
<li>
<p>Cons: Circular dependency and high coupling, potentially leading to lower testability and a higher bug count.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rule-management-feature"><a class="link" href="#rule-management-feature">3.7. Rule Management Feature</a></h3>
<div class="paragraph">
<p>The Rules feature exists as an integration onto the Transaction system. It makes use
of syntax processing, together with scripts to provide an automation solution to
repetitive tasks when adding transactions.</p>
</div>
<div class="paragraph">
<p>Rules are defined with a pair of predicate and action, where an action is performed
given that the predicate returns true. This predicate-action split allows us to decouple
testing from performing, which helps to increase reusability of individual predicates
and actions.</p>
</div>
<div class="sect3">
<h4 id="implementation-6"><a class="link" href="#implementation-6">3.7.1. Implementation</a></h4>
<div class="paragraph">
<p>Basic attributes and operators are exposed to provide users a way of writing simple
tests on transactions without having to manually check and make changes. Storing rules
works similarly to LoansManager, where individual rules are stored in a
<code>RuleManager</code> which manages all CRUD operations.</p>
</div>
<div class="paragraph">
<p>All rules are stored in a JSON file when added, formatted to be retrieved and parsed by the
application when relaunched.</p>
</div>
<div class="paragraph">
<p>The following class diagram illustrates the structure of the <code><strong>Rule</strong></code> Model component.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/RuleModelClassDiagram.png" alt="RuleModelClassDiagram">
</div>
<div class="title">Figure 18. Structure of the Rule Model Component</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The rest of the <code><strong>Script</strong></code> and <code><strong>Model</strong></code> components have been omitted to give focus on the <code>Rule</code> model component.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As mentioned above, rules are defined as a pair of predicate and action, which as seen in the above diagram, is divided into
the two abstract classes <code><strong>RulePredicate</strong></code> and <code><strong>RuleAction</strong></code>. These two classes are abstract due to two implementation
types, either script or expression. Their concrete classes are <code><strong>PredicateExpression</strong></code> and <code><strong>ActionExpression</strong></code>
for expressions and <code><strong>PredicateScript</strong></code> and <code><strong>ActionScript</strong></code> for scripts respectively.</p>
</div>
<div class="paragraph">
<p>For predicate expressions, they are formed using binary comparison operations, which means that each expression contains
a predefined <code><strong>Operator</strong></code> which takes in two arguments, a predefined <code><strong>Attribute</strong></code> to represent an attribute of a <code><strong>Transaction</strong></code>,
as well as a <code><strong>Value</strong></code> to represent a given value to test against the attribute.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Here is an example of a part of what a user may type as a predicate expression:<br>
<code>p/outamt &lt; 10</code></p>
</div>
<div class="paragraph">
<p>This is split into the <strong>Attribute:</strong> <code>outamt</code> , the <strong>Operator:</strong> <code>&lt;</code> , as well as the <strong>Value:</strong> <code>10</code> .</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Action expressions are unary operations, which means that each expression is formed with an <code><strong>Operator</strong></code> as well, but takes
only a single argument, a <code><strong>Value</strong></code> to represent a given value to carry out the operation with.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>Again, here is an example of a part of what a user may type as an action expression:<br>
<code>a/set_cat Cheap</code></p>
</div>
<div class="paragraph">
<p>This is split into the <strong>Operator:</strong> <code>set_cat</code> , as well as the <strong>Value:</strong> <code>Cheap</code> .</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Predicates and actions implemented as scripts on the other hand are each defined with a single <code><strong>ScriptName</strong></code>, which refers to the
name of the script itself.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>An example of both predicate and action script names a user may type:<br>
<code>p/CheckIsTransport a/SetTransportFare</code></p>
</div>
<div class="paragraph">
<p>In this case, both <code>CheckIsTransport</code> and <code>SetTransportFare</code> are <code><strong>ScriptName</strong></code>s .</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Each and every <code><strong>Rule</strong></code> is stored within the <code><strong>RuleManager</strong></code>, which serves as an interface to manipulating the list of rules.
For example, <code><strong>RuleManager#addRule</strong></code> is used to add new rules to the list, whereas <code><strong>RuleManager#swapRules</strong></code> is used to
swap the order of two rules in the list. The <code><strong>RuleManager</strong></code> supports basic <strong>CRUD</strong> operations, as well as other convenience
methods such as the <code><strong>RuleManager#swapRules</strong></code> as mentioned.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-5"><a class="link" href="#design-considerations-5">3.7.2. Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-structure-of-expressions-for-rule-data-management"><a class="link" href="#aspect-structure-of-expressions-for-rule-data-management">Aspect: Structure of expressions for rule data management</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: The two expression classes <code><strong>PredicateExpression</strong></code> and <code><strong>ActionExpression</strong></code>
are split into their individual components, the operators and the arguments.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: More control over the expression format, and increase reusability of individual components.</p>
</li>
<li>
<p>Cons: More classes required to implement, greater overhead.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong>: Expressions are just entirely stored as strings within the two classes.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to implement, ease of storage.</p>
</li>
<li>
<p>Cons: Parsing has to be done even after the rule is added. This means we need to parse the expression more than once,
not only to check the validity, but again to process the rule before execution.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-structure-of-scripts-for-rule-data-management"><a class="link" href="#aspect-structure-of-scripts-for-rule-data-management">Aspect: Structure of scripts for rule data management</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: The two script classes <code><strong>PredicateScript</strong></code> and <code><strong>ActionScript</strong></code> contain only a
<code><strong>ScriptName</strong></code>, which is the name of the script they are referencing.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: No need to reference an entire script, and therefore much easier to validate. Storing names will also be much simpler.</p>
</li>
<li>
<p>Cons: Requires checking against the <code><strong>ScriptLibrary</strong></code> to retrieve a <code><strong>Script</strong></code> when processing rules.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong>: The classes will each store an entire <code><strong>Script</strong></code> within them.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Referencing the script code when processing rules will not require access to the <code><strong>ScriptLibrary</strong></code>, and can be
taken directly from the <code><strong>PredicateScript</strong></code> or <code><strong>ActionScript</strong></code> directly.</p>
</li>
<li>
<p>Cons: Creating unnecessary entire references to a script that already exists in the <code><strong>ScriptLibrary</strong></code>, and makes storage
much more complicated, as the entire script will be contained within the class.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rule-execution-feature"><a class="link" href="#rule-execution-feature">3.8. Rule Execution Feature</a></h3>
<div class="paragraph">
<p>The structure of rules were separated from the logic of rule execution to maintain the separation of concerns between the
<code><strong>Model</strong></code> and <code><strong>Logic</strong></code> components.</p>
</div>
<div class="paragraph">
<p>Rule execution is hooked into the evaluation of adding or editing a <code><strong>Transaction</strong></code>. This means that for every new transaction,
all rules within the Rule Engine will be executed on that transaction. The same can be said for modifying a transaction.</p>
</div>
<div class="paragraph">
<p>The implementation of the Rule execution is elaborated on below.</p>
</div>
<div class="sect3">
<h4 id="implementation-7"><a class="link" href="#implementation-7">3.8.1. Implementation</a></h4>
<div class="paragraph">
<p>The <code><strong>RuleEngine</strong></code> is a static class used for interfacing with all the rule processings functionality.</p>
</div>
<div class="paragraph">
<p>Two executable classes are used in the execution of a rule, <code><strong>Testable</strong></code> and <code><strong>Performable</strong></code>.
A <code><strong>Testable</strong></code> represents the executable form of a <code><strong>RulePredicate</strong></code>, which may be either an expression or a script.
Correspondingly, a <code><strong>Performable</strong></code> represents the executable form of a <code><strong>RuleAction</strong></code>, which may also be either an
expression or a script.</p>
</div>
<div class="paragraph">
<p>Before executing the existing rules, the index of the transaction and the account that the transaction belongs to are
supplied to the <code><strong>RuleEngine</strong></code> through the <code><strong>RuleEngine#executeRules</strong></code> method. This allows for the retrieval of the transaction
when a rule is executed against it.</p>
</div>
<div class="paragraph">
<p>When a rule is executed, this is firstly represented as the execution of the <code><strong>Testable#test</strong></code> method on the given transaction.
If the test passes, the predicate is true, and therefore the action is performed. This is represented as the execution of
the <code><strong>Performable#perform</strong></code> method on the given transaction.</p>
</div>
<div class="paragraph">
<p>The following sequence diagram shows the interaction between the <code><strong>RuleEngine</strong></code> and the different objects involved in the
execution of the rules on a transaction:</p>
</div>
<div id="rule-execution-sequence-diagram" class="imageblock">
<div class="content">
<img src="images/RuleExecutionSequenceDiagram.png" alt="RuleExecutionSequenceDiagram">
</div>
<div class="title">Figure 19. Sequence diagram representing Rule Execution after adding a new Transaction</div>
</div>
<div class="paragraph">
<p>Shown above is a sequence diagram which takes place during the execution of the <code><strong>TransactionAddCommand</strong></code>,
after the new transaction has already been added. The <code><strong>RuleEngine</strong></code> takes over, and retrieves the relevant handlers from
<code><strong>Model</strong></code>.</p>
</div>
<div class="paragraph">
<p>Thereafter, the list of rules is retrieved from the <code><strong>RuleManager</strong></code>. The <code><strong>RuleEngine</strong></code> iterates through the list,
using the <code><strong>RulePredicate</strong></code> and <code><strong>RuleAction</strong></code> of each rule to create the required <code><strong>Testable</strong></code>s for testing on the
transaction, as well as the <code><strong>Performable</strong></code>s for performing the action.</p>
</div>
<div class="paragraph">
<p>The following activity diagram shows in greater detail the workflow of executing rules.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/RuleExecutionActivityDiagram.png" alt="RuleExecutionActivityDiagram">
</div>
<div class="title">Figure 20. Activity diagram of the different paths involved in the workflow of executing rules</div>
</div>
<div class="paragraph">
<p>The activity diagram above has a slightly different context as the sequence diagram, to show a separate use case. In this
diagram, instead of a new transaction that is added, we have a transaction that is edited. Both types of commands do not affect
the workflow of rule execution.</p>
</div>
<div class="paragraph">
<p>In this diagram, the generation of a <code><strong>Testable</strong></code> and <code><strong>Performable</strong></code> is shown in greater detail.</p>
</div>
<div class="paragraph">
<p><code><strong>Testable</strong></code> is an interface which, like <code><strong>RulePredicate</strong></code>, have its implementations split into expressions and scripts,
namely <code><strong>TestableExpression</strong></code> and <code><strong>TestableScript</strong></code>.</p>
</div>
<div class="paragraph">
<p>Similarly, <code><strong>Performable</strong></code> is an interface which, like <code><strong>RuleAction</strong></code>, have its implementations split into expressions
and scripts, namely <code><strong>PerformableExpression</strong></code> and <code><strong>PerformableScript</strong></code>.</p>
</div>
<div class="paragraph">
<p>Expressions are generated by the <code><strong>RuleEngine</strong></code> when either the <code><strong>RulePredicate</strong></code> or <code><strong>RuleAction</strong></code> are of the expression type.
The <code><strong>RuleEngine</strong></code> will retrieve the correct expression constructor from an internal hash map based on the <code><strong>Operator</strong></code>,
and create the expression using the given attribute and/or value.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>For example, we have an predicate <code>p/desc contains food</code>. One of the classes implementing <code><strong>TestableExpression</strong></code>,
<code><strong>ContainsExpression</strong></code>, is created since the predicate has the <strong>Operator:</strong> <code>contains</code>. The corresponding <strong>Attribute:</strong> <code>desc</code>
and <strong>Value:</strong> <code>food</code> in the predicate are provided into the <code><strong>ContainsExpression</strong></code> constructor during instantiation.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Scripts, on the other hand, are generated by the <code><strong>RuleEngine</strong></code> when either the <code><strong>RulePredicate</strong></code> or <code><strong>RuleAction</strong></code> are of
the script type. The <code><strong>RuleEngine</strong></code> will generate the corresponding <code><strong>Testable</strong></code> or <code><strong>Performable</strong></code> by first retrieving
the script from the <code><strong>ScriptLibrary</strong></code> based on its <code><strong>ScriptName</strong></code>. Following that, a <code><strong>TestableScript</strong></code> or <code><strong>PerformableScript</strong></code>
is instantiated with a function <code><strong>ScriptEvaluator</strong></code>, which evaluates the script given the transaction and account. This
function is then called when <code><strong>Testable#test</strong></code> or <code><strong>Performable#perform</strong></code> is executed.</p>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-6"><a class="link" href="#design-considerations-6">3.8.2. Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-duplication-of-predicates-and-actions-in-model-and-logic"><a class="link" href="#aspect-duplication-of-predicates-and-actions-in-model-and-logic">Aspect: Duplication of predicates and actions in model and logic</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: Both predicates and actions have their corresponding versions in both model and logic.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Able to split the logic flow and execution code from the data in model.</p>
</li>
<li>
<p>Cons: Seemingly duplicate classes, such as <code><strong>PredicateExpression</strong></code> and <code><strong>TestableExpression</strong></code>, which increases the number
of classes.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong>: All execution data and logic is stored in the rule model rather than logic.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Reduce class duplication, less confusion.</p>
</li>
<li>
<p>Cons: <code><strong>Model</strong></code> and <code><strong>Logic</strong></code> will have unnecessary coupling which reduces testability and makes maintenance and integration harder.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="scripting"><a class="link" href="#scripting">3.9. Scripting</a></h3>
<div class="paragraph">
<p>The scripting feature allows users to write scripts to automate tasks and extend the
functionality of Budget Buddy.</p>
</div>
<div class="sect3">
<h4 id="implementation-8"><a class="link" href="#implementation-8">3.9.1. Implementation</a></h4>
<div class="paragraph">
<p>The script engine works independently of the rest of the application.
At its core, it uses the
<a href="https://docs.oracle.com/en/java/javase/11/nashorn/nashorn-java-api.html">Nashorn ECMAScript 5.1</a>
engine bundled with Java 11 to evaluate scripts.</p>
</div>
<div class="paragraph">
<p>A set of convenience functions are provided to make basic tasks, such as manipulating
transactions and accounts, easier. The full model is nevertheless exposed to
scripts, and scripts are able to access any classes provided in the Java 11 standard
library, as well as any dependencies included in the application.</p>
</div>
<div class="paragraph">
<p>There is a simple mechanism to store scripts to be run in future. This works together
with rules to give the ability to have complex predicates and actions outside of
those supported inherently by the program.</p>
</div>
<div class="paragraph">
<p>When the <a href="#aliases">proposed alias feature</a> is implemented, scripts and aliases can be
used together to, in effect, allow users to create custom commands.</p>
</div>
<div class="paragraph">
<p>The following class diagram illustrates the design of the script engine and model. For clarity, parts of the model and logic components that do not interact directly with the script engine are omitted.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ScriptsClassDiagram.png" alt="ScriptsClassDiagram">
</div>
<div class="title">Figure 21. Structure of scripts in the model and logic components</div>
</div>
<div class="sect4">
<h5 id="script-engine"><a class="link" href="#script-engine">Script engine</a></h5>
<div class="paragraph">
<p>The logic component of the scripts feature contains the
<a href="https://github.com/AY1920S1-CS2103T-W13-4/main/blob/master/src/main/java/budgetbuddy/logic/script/ScriptEngine.java"><code>ScriptEngine</code></a>
class which underpins the entire scripting component. At its heart, the <code>ScriptEngine</code> class is
simply a thin layer to abstract away the underlying script engine (in our case, Nashorn). It contains a method
<code>evaluateScript</code> that accepts a string of script code, and arguments for the script, and
then evaluates the script. There is an overload of <code>evaluateScript</code> that accepts a <code>Script</code>
from the script model, which is simply a convenience method. There is no other relationship
between the logic and model components.</p>
</div>
<div class="paragraph">
<p>The logic component also contains methods <code>setVariable</code>, <code>addToEnvironment</code> and <code>resetEnvironment</code>
that allow functions and variables to be set in the script environment, to provide helper functions
to the scripts, like those in the <a href="UserGuide.html#scripting-api">Scripting API</a>.</p>
</div>
<div class="paragraph">
<p>To allow other components to add helper functions to the script environment,
without the script engine having to be aware of those components,
the <code>ScriptEngine</code> accepts <code>ScriptEnvironmentInitialiser</code>s. A <code>ScriptEnvironmentInitialiser</code>
is a <code>FunctionalInterface</code> that simply accepts a <code>ScriptEngine</code> and does some setup
on it e.g. setting variables and functions using <code>ScriptEngine#setVariable</code>. <code>ScriptEngine</code>
maintains a list of <code>ScriptEnvironmentInitialiser</code>s and re-applies them each time
<code>ScriptEngine#resetEnvironment</code> is called.</p>
</div>
</div>
<div class="sect4">
<h5 id="library-and-storage"><a class="link" href="#library-and-storage">Library and storage</a></h5>
<div class="paragraph">
<p>The model component of the scripts feature is a simple script library that allows
users to store scripts with a name and a description for repeated use. See the interface
<a href="https://github.com/AY1920S1-CS2103T-W13-4/main/blob/master/src/main/java/budgetbuddy/model/ScriptLibrary.java"><code>ScriptLibrary</code></a>
and its implementation
<a href="https://github.com/AY1920S1-CS2103T-W13-4/main/blob/master/src/main/java/budgetbuddy/model/ScriptLibraryManager.java"><code>ScriptLibraryManager</code></a>.</p>
</div>
<div class="paragraph">
<p>Scripts are persisted as individual files under the <code>scripts/</code> directory in
Budget Buddy&#8217;s data directory. Script names are not stored separately, but simply
used as the file name of the scripts with a <code>.js</code> extension. See
<a href="https://github.com/AY1920S1-CS2103T-W13-4/main/blob/master/src/main/java/budgetbuddy/storage/scripts/FlatfileScriptsStorage.java"><code>FlatfileScriptsStorage</code></a>.</p>
</div>
<div class="paragraph">
<p>The script descriptions are stored in a separate <code>descriptions.json</code> file.</p>
</div>
</div>
<div class="sect4">
<h5 id="user-interface"><a class="link" href="#user-interface">User interface</a></h5>
<div class="paragraph">
<p>The last component of the scripts feature is the user interface.</p>
</div>
<div class="paragraph">
<p>The script engine is presented to the user as a set of simple commands.
<a href="UserGuide.html#script-eval"><code>script eval</code></a> and <a href="UserGuide.html#script-run"><code>script run</code></a>
run scripts, while <a href="UserGuide.html#script-reset"><code>script reset</code></a> resets the script environment.
<a href="UserGuide.html#script-add"><code>script add</code></a>, <a href="UserGuide.html#script-list"><code>script list</code></a>
and <a href="UserGuide.html#script-delete"><code>script delete</code></a> manage the script library.</p>
</div>
<div class="paragraph">
<p>The following sequence diagram shows the interaction between the different components
when the user runs a script from the script library using <code>script run my-script</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/ScriptsSequenceDiagram.png" alt="ScriptsSequenceDiagram">
</div>
<div class="title">Figure 22. Interaction between the components during the execution of <code>script run my-script</code></div>
</div>
<div class="paragraph">
<p>The command is parsed into <code>ScriptRunCommand</code> by the command line parser.
<code>ScriptRunCommand</code> then retrieves the <code>Script</code> from the <code>ScriptLibraryManager</code>
and then hands the <code>Script</code> to <code>ScriptEngine</code> for evaluation.</p>
</div>
</div>
<div class="sect4">
<h5 id="script-bindings"><a class="link" href="#script-bindings">Script bindings</a></h5>
<div class="paragraph">
<p>Script bindings are added via
<a href="https://github.com/AY1920S1-CS2103T-W13-4/main/blob/master/src/main/java/budgetbuddy/logic/script/ScriptEnvironmentInitialiser.java"><code>ScriptEnvironmentInitialiser</code>s</a>, which are registed with the <code>ScriptEngine</code> through <code>Logic#addToScriptEnvironment</code>.</p>
</div>
<div class="paragraph">
<p>Most of the functions exposed in the <a href="UserGuide.html#scripting-api">Scripting API</a>
come from the script-model bindings, in
<a href="https://github.com/AY1920S1-CS2103T-W13-4/main/blob/master/src/main/java/budgetbuddy/logic/script/ScriptModelBinding.java"><code>ScriptModelBinding</code></a>.
JavaFX-specific bindings are added in
<a href="https://github.com/AY1920S1-CS2103T-W13-4/main/blob/master/src/main/java/budgetbuddy/ui/ScriptUiBinding.java"><code>ScriptUiBinding</code></a>,
and bindings that require access to <code>MainWindow</code> internals are added in a private inner class of <code>MainWindow</code>.</p>
</div>
<div class="paragraph">
<p>Methods in the binding classes are added into the script environment by casting
their method references to appropriate <code>FunctionalInterface</code>s. Nashorn allows
objects which implement a <code>FunctionalInterface</code> to be called as if they were
functions, providing an ergonomic scripting experience for the user. Nashorn also
helps to do some type conversion from JavaScript types to Java types, saving on
the amount of boilerplate required in our implementation.</p>
</div>
<div class="paragraph">
<p>We declare an
entire suite of functional interfaces in
<a href="https://github.com/AY1920S1-CS2103T-W13-4/main/blob/master/src/main/java/budgetbuddy/logic/script/ScriptBindingInterfaces.java"><code>ScriptBindingInterfaces</code></a>.</p>
</div>
<div class="paragraph">
<p>We do not use the functional interfaces provided in the Java package <code>java.util.function</code>
because of these reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>These interfaces cannot be used if the methods throw any checked exceptions.
Many script methods involve parsing strings into appropriate model types, which
means that parsing exceptions need to be thrown, but they are checked exceptions.</p>
</li>
<li>
<p>These interfaces have generic type parameters. However, because Java implements
generics using type erasure, it is not possible for Nashorn to determine the actual
types of parameters, in order to do automatic conversion between JavaScript and Java
types, if functional interfaces with generic type parameters were used.
(They would all appear as <code>Object</code> at runtime.) This is also the reason that we do
not use generics in the functional interfaces in <code>ScriptBindingInterfaces</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-7"><a class="link" href="#design-considerations-7">3.9.2. Design considerations</a></h4>
<div class="sect4">
<h5 id="aspect-javascript-engine"><a class="link" href="#aspect-javascript-engine">Aspect: JavaScript engine</a></h5>
<div class="paragraph">
<p>Two JavaScript engines were considered.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: Use the Nashorn JavaScript engine.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: It is bundled with Java 11.</p>
</li>
<li>
<p>Cons: It is deprecated and marked for removal in a future Java version, and
it also interprets scripts, so it is slower than GraalVM.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong>: Use the GraalVM engine.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: It is well-maintained, and it also just-in-time (JIT) compiles scripts,
so it will be faster than Nashorn.</p>
</li>
<li>
<p>Cons: It is not bundled with Java 11, so it is an additional dependency.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>We chose Nashorn because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>While it is slower, it is not too slow for the kinds of lightweight scripting tasks
in Budget Buddy.</p>
</li>
<li>
<p>While it is deprecated, we are targetting specifically Java 11, so its future removal
is not a concern at this moment.</p>
</li>
<li>
<p>It is bundled with Java 11, so we do not need to manage and ship an additional
dependency.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="aspect-script-bindings"><a class="link" href="#aspect-script-bindings">Aspect: Script bindings</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice)</strong>: Use functional interfaces.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: It requires less marshalling code in Budget Buddy, because Nashorn helps
to perform most of the type conversion.</p>
</li>
<li>
<p>Cons: Many functional interfaces need to be declared for every unique method
signature exposed to the script environment.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2</strong>: Extend Nashorn&#8217;s
<a href="https://docs.oracle.com/javase/8/docs/jdk/api/nashorn/jdk/nashorn/api/scripting/AbstractJSObject.html"><code>AbstractJSObject</code></a>,
overriding the <code>call</code> method.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: No extra declarations (e.g. functional interfaces) need to be made if a
new method signature is to be exposed to the script environment.</p>
</li>
<li>
<p>Cons: Nashorn&#8217;s built-in type conversion and marshalling are not applicable; it
has to be done manually in our <code>AbstractJSObject</code> subclass.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="aliases"><a class="link" href="#aliases">3.10. [Proposed] Aliases</a></h3>
<div class="paragraph">
<p>The alias is a simple hook into the command parsing engine. If there is no
built-in command corresponding to a command line, then the alias map is checked.
If there is a matching alias, then the alias name in the command line is replaced,
and the command execution is re-tried.</p>
</div>
<div class="paragraph">
<p>To prevent alias loops where the user creates an alias <code>x</code> mapping to <code>y</code>, and an
alias <code>y</code> mapping to <code>x</code>, we track the aliases that have been applied, and
stop evaluation if we see that the same alias has been applied more than once.</p>
</div>
<div class="paragraph">
<p>The following activity diagram illustrates the above algorithm.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/AliasActivityDiagram.png" alt="AliasActivityDiagram">
</div>
<div class="title">Figure 23. Alias resolution algorithm</div>
</div>
</div>
<div class="sect2">
<h3 id="logging"><a class="link" href="#logging">3.11. Logging</a></h3>
<div class="paragraph">
<p>We are using <code>java.util.logging</code> package for logging. The <code>LogsCenter</code> class is used to manage the logging levels and logging destinations.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The logging level can be controlled using the <code>logLevel</code> setting in the configuration file (See <a href="#Implementation-Configuration">Section 3.12, &#8220;Configuration&#8221;</a>)</p>
</li>
<li>
<p>The <code>Logger</code> for a class can be obtained using <code>LogsCenter.getLogger(Class)</code> which will log messages according to the specified logging level</p>
</li>
<li>
<p>Currently log messages are output through: <code>Console</code> and to a <code>.log</code> file.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Logging Levels</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SEVERE</code> : Critical problem detected which may possibly cause the termination of the application</p>
</li>
<li>
<p><code>WARNING</code> : Can continue, but with caution</p>
</li>
<li>
<p><code>INFO</code> : Information showing the noteworthy actions by the App</p>
</li>
<li>
<p><code>FINE</code> : Details that is not usually noteworthy but may be useful in debugging e.g. print the actual list instead of just its size</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Implementation-Configuration"><a class="link" href="#Implementation-Configuration">3.12. Configuration</a></h3>
<div class="paragraph">
<p>Certain properties of the application can be controlled (e.g user prefs file location, logging level) through the configuration file (default: <code>config.json</code>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="documentation"><a class="link" href="#documentation">4. Documentation</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Refer to the guide <a href="Documentation.html">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing"><a class="link" href="#testing">5. Testing</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Refer to the guide <a href="Testing.html">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dev-ops"><a class="link" href="#dev-ops">6. Dev Ops</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Refer to the guide <a href="DevOps.html">here</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="product-scope"><a class="link" href="#product-scope">Appendix A: Product Scope</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Target user profile</strong>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>has a need to manage expenses and income over a significant period of time</p>
</li>
<li>
<p>prefer desktop apps over other types</p>
</li>
<li>
<p>can type fast</p>
</li>
<li>
<p>prefers typing over mouse input</p>
</li>
<li>
<p>is reasonably comfortable using CLI apps</p>
</li>
<li>
<p>capable of basic programming to customize the app to their liking</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Value proposition</strong>: manage expenses/income faster than a typical mouse/GUI driven app</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="user-stories"><a class="link" href="#user-stories">Appendix B: User Stories</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Priorities: High (must have) - <code>* * *</code>, Medium (nice to have) - <code>* *</code>, Low (unlikely to have) - <code>*</code></p>
</div>
<table class="tableblock frame-all grid-all" style="width: 59%;">
<colgroup>
<col style="width: 22%;">
<col style="width: 23%;">
<col style="width: 25%;">
<col style="width: 30%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Priority</th>
<th class="tableblock halign-left valign-top">As a &#8230;&#8203;</th>
<th class="tableblock halign-left valign-top">I want to &#8230;&#8203;</th>
<th class="tableblock halign-left valign-top">So that I can&#8230;&#8203;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see an overview of all my spending from month to month</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">better judge my expense/income ratio</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user who borrows and loans money frequently</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">track who owes me money/who I owe money to</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">settle my debts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">careful spender</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dedicate different accounts to different holidays</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">control how much I spend while on the holidays</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">busy user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">keep track of my spending in different account books</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">segregate completely unrelated spending</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lazy user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">simplify repetitive actions by setting rules for every transaction added</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">automate repetitive and tedious processes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* * *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SoC student experienced in writing programs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">write my own scripts to manipulate entries in the app</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">automate and customize the app to my liking</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spendthrift</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set a budget for my monthly spending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">avoid breaking the bank again</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lazy user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">key in recurring expenses just once</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">do not have to enter them over and over again</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">careful spender</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">make month-to-month comparisons of spending in a particular category</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see where additional expenses for certain months come from</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cautious spender</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">carry over any budget deficits incurred each month to the following month</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">remember to repay it</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SoC student who has to pay school fees regularly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">track how much I’ll have to pay and when I have to pay it by</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">avoid making late payments</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ambitious user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set goals for my cumulative income</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">work towards my dream home/car/goal</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">careless user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">undo a mistake</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not worry even if I accidentally make an error</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">careful spender</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set different currencies for different accounts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see my expenditure during a holiday in the local currency</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lazy person</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">import expenses from csv exports from internet banking</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">transfer my records across software</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">supremely lazy user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">have the program detect recurring transactions and suggest them to me</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not waste time adding them manually</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">paranoid user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">have the program show me all possible commands and how to use them</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">know exactly what I am doing</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user who prefers visuals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see a chart of my budget spending across past months</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see how much I have been overspending/underspending</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">busy user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">move and delete multiple transactions at the same time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">be more efficient</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lazy user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">have the program autofill my command as I am typing it</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">enter my transactions more quickly</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user who cannot control spending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">set a budget for different purposes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">control my spending</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lazy user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">have the app to have predictive commands based on what transactions I commonly include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spend less time typing in my expenses</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fast typer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type out multiple commands all at once</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type the next command without having to pause</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">person who occasionally goes overseas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">assign an exchange rate to each foreign currency transaction</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">get reports on my total expenditure in my home currency</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">busy user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see my overall budget surplus/deficit at a glance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">know straight away when I’m below or above my budget for that month</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>* *</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">meticulous user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">see how much I need to budget every month to reach a savings goal based on what the goal is and its deadline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">plan my budget well</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unmotivated person</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">be rewarded for entering my expenses/income daily</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">be motivated to do so and eventually turn it into a habit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">expense planner</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">record down possible future expenses</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">keep track of what I planned to spend on</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">forgetful user</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">have the app set reminders</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">keep track of my spending everyday</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="use-cases"><a class="link" href="#use-cases">Appendix C: Use Cases</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>(For all use cases below, the <strong>System</strong> is <code>Budget Buddy</code> and the <strong>Actor</strong> is the <code>user</code>, unless specified otherwise)</p>
</div>
<h3 id="use-case-delete-transaction" class="discrete">Use case: Delete transaction</h3>
<div class="paragraph">
<p><strong>MSS</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User requests to list transactions.</p>
</li>
<li>
<p>Budget Buddy shows a list of transactions for the current account.</p>
</li>
<li>
<p>User requests to delete a specific transaction in the list.</p>
</li>
<li>
<p>Budget Buddy deletes the transaction.</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Extensions</strong></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>2a. The list is empty.</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
<li>
<p>3a. The given index is invalid.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>3a1. Budget Buddy shows an error message.</p>
<div class="paragraph">
<p>Use case resumes at step 2.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="use-case-add-loan"><a class="link" href="#use-case-add-loan">C.1. Use case: Add loan</a></h3>
<div class="paragraph">
<p><strong>MSS</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User requests to add a <a href="#loan-out">loan out</a>.</p>
</li>
<li>
<p>Budget Buddy adds the loan for the given person.</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Extensions</strong></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>1a. The given loan out value is not positive.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>1a1. Budget Buddy shows an error message.</p>
<div class="paragraph">
<p>Use case resumes at step 1.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="use-case-edit-loan"><a class="link" href="#use-case-edit-loan">C.2. Use case: Edit loan</a></h3>
<div class="paragraph">
<p><strong>MSS</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User requests to list loans.</p>
</li>
<li>
<p>Budget Buddy shows a list of loans.</p>
</li>
<li>
<p>User requests to edit the description of a loan in the list.</p>
</li>
<li>
<p>Budget Buddy edits the description of the specified loan.</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Extensions</strong></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>2a. The list is empty.</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
<li>
<p>2a. The given loan index is invalid.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>2a1. Budget Buddy shows an error message.</p>
<div class="paragraph">
<p>Use case resumes at step 2.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="use-case-add-account"><a class="link" href="#use-case-add-account">C.3. Use case: Add account</a></h3>
<div class="paragraph">
<p><strong>MSS</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User requests to add a new account.</p>
</li>
<li>
<p>Budget Buddy creates the new account.</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Extensions</strong></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>1a. No account name was provided.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>1a1. Budget Buddy shows an error message.</p>
<div class="paragraph">
<p>Use case resumes at step 1.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="use-case-add-rule"><a class="link" href="#use-case-add-rule">C.4. Use case: Add rule</a></h3>
<div class="paragraph">
<p><strong>MSS</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>User requests to add a new rule.</p>
</li>
<li>
<p>Budget Buddy creates the new rule.</p>
<div class="paragraph">
<p>Use case ends.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Extensions</strong></p>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>1a. No predicate was provided.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>1a1. Budget Buddy shows an error message.</p>
<div class="paragraph">
<p>Use case resumes at step 1.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>1b. No action was provided.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>1b1. Budget Buddy shows an error message.</p>
<div class="paragraph">
<p>Use case resumes at step 1.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist none">
<ul class="none">
<li>
<p>1c. Predicate is an expression but not in the form of &lt;attribute&gt; &lt;operator&gt; &lt;value&gt;.</p>
<div class="ulist none">
<ul class="none">
<li>
<p>1c1. Budget Buddy shows an error message.</p>
<div class="paragraph">
<p>Use case resumes at step 1.</p>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="non-functional-requirements"><a class="link" href="#non-functional-requirements">Appendix D: Non Functional Requirements</a></h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Should work on any <a href="#mainstream-os">mainstream OS</a> as long as it has Java <code>11</code> or above installed.</p>
</li>
<li>
<p>Should be able to hold up to 1000000 transactions without a noticeable sluggishness in performance for typical usage.</p>
</li>
<li>
<p>A user with above average typing speed for regular English text (i.e. not code, not system admin commands) should be able to accomplish most of the tasks faster using commands than using the mouse.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="glossary"><a class="link" href="#glossary">Appendix E: Glossary</a></h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><a id="mainstream-os"></a> Mainstream OS</dt>
<dd>
<p>Windows, Linux, Unix, OS-X</p>
</dd>
<dt class="hdlist1"><a id="loan-out"></a> Loan Out</dt>
<dd>
<p>A loan where the user has lent money to another person.</p>
</dd>
<dt class="hdlist1"><a id="loan-in"></a> Loan In</dt>
<dd>
<p>A loan where the user has borrowed money from another person.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="instructions-for-manual-testing"><a class="link" href="#instructions-for-manual-testing">Appendix F: Instructions for Manual Testing</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Given below are instructions to test the app manually.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These instructions only provide a starting point for testers to work on.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="launch-and-shutdown"><a class="link" href="#launch-and-shutdown">F.1. Launch and Shutdown</a></h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Initial launch</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Download the jar file and copy into an empty folder</p>
</li>
<li>
<p>Double-click the jar file<br>
Expected: Shows the GUI starting in the transaction panel. The window size may not be optimum.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Saving window preferences</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Resize the window to an optimum size. Move the window to a different location. Close the window.</p>
</li>
<li>
<p>Re-launch the app by double-clicking the jar file.<br>
Expected: The most recent window size and location is retained.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="accounts"><a class="link" href="#accounts">F.2. Accounts</a></h3>
<div class="sect3">
<h4 id="adding-an-account"><a class="link" href="#adding-an-account">F.2.1. Adding an Account</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adding an account when no duplicate account exists in the list</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: None</p>
</li>
<li>
<p>Test case: <code>account add n/food</code><br>
Expected: An account with name "food" is added to the current list of accounts.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="deleting-an-account"><a class="link" href="#deleting-an-account">F.2.2. Deleting an Account</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deleting an account while all accounts are listed</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: List all persons using the <code>account list</code> command. More than one account in the list.</p>
</li>
<li>
<p>Test case: <code>account delete 1</code><br>
Expected: First account is deleted from the list. Details of the deleted account shown in the status message.</p>
</li>
<li>
<p>Test case: <code>account delete 0</code><br>
Expected: No account is deleted. Error details shown in the status message.</p>
</li>
<li>
<p>Other incorrect delete commands to try: <code>account delete</code>, <code>account delete x</code> (where x is larger than the list size)<br>
Expected: Similar to previous.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="editing-an-account"><a class="link" href="#editing-an-account">F.2.3. Editing an Account</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Editing one or all specified fields of an existing account from the account list</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: List all accounts using the <code>account list</code> command. At least one account in the list.</p>
</li>
<li>
<p>Test case: <code>account edit 1 n/food</code><br>
Expected: The name field of the first account is changed to "food".</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="finding-account-s"><a class="link" href="#finding-account-s">F.2.4. Finding Account(s)</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Finding account(s) that contain specified keyword in their names</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: None.</p>
</li>
<li>
<p>Test case: <code>account find trip</code><br>
Expected: Account(s) that contain the keyword "trip" in their names will be listed.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="viewing-the-report-of-an-account"><a class="link" href="#viewing-the-report-of-an-account">F.2.5. Viewing the Report of an Account</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Viewing the details of an existing account in the account list</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: None.</p>
</li>
<li>
<p>Test case: <code>account report 2</code><br>
Expected: The details of the account will be displayed in the commandBox textfield.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="viewing-the-report-of-all-accounts"><a class="link" href="#viewing-the-report-of-all-accounts">F.2.6. Viewing the Report of all Accounts</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Viewing the reports of all accounts to have an overview of the user&#8217;s financial status.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisite: None.</p>
</li>
<li>
<p>Test case: <code>account overview</code><br>
Expected: Successful message will be displayed, with an html file generated containing the overview
in the exports folder.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="loans"><a class="link" href="#loans">F.3. Loans</a></h3>
<div class="sect3">
<h4 id="adding-a-loan"><a class="link" href="#adding-a-loan">F.3.1. Adding a Loan</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adding a loan when no duplicate loan exists in the list</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: None</p>
</li>
<li>
<p>Test case: <code>loan out x/4.20 p/John d/For dinner</code><br>
Expected: A loan is added to the list at the appropriate position based on the current sorting order.
The date of the loan should be the current system date.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="listing-loans"><a class="link" href="#listing-loans">F.3.2. Listing Loans</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Listing loans in the main display panel with optional filtering/sorting</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: None</p>
</li>
<li>
<p>Test case: <code>loan list</code>
Expected: All loans are listed.</p>
</li>
<li>
<p>Test case: <code>loan list out p/John s/p</code>
Expected: Only loans out involving the person "John" are listed.
The list is also sorted by person in alphabetical order.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="editing-a-loan"><a class="link" href="#editing-a-loan">F.3.3. Editing a Loan</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Editing an existing loan while all loans are listed</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: List all loans using the <code>loan list</code> command. At least one loan in the list.</p>
</li>
<li>
<p>Test case: <code>loan edit 1 x/500</code>
Expected: First loan&#8217;s amount is changed to $500 and it is sorted into the appropriate position based on the current sorting order.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="marking-a-loan-as-paid"><a class="link" href="#marking-a-loan-as-paid">F.3.4. Marking a Loan as Paid</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Marking an existing loan as paid while all loans are listed</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: List all loans using the <code>loan list</code> command. At least one loan in the list that is unpaid.</p>
</li>
<li>
<p>Test case: <code>loan paid 1</code>
Expected: First loan is marked as paid. A "tick" icon should appear to the left of the loan&#8217;s index.</p>
</li>
<li>
<p>Test case: <code>loan paid p/John</code>
Expected: All loans pertaining to the person "John" are marked as paid.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="marking-a-loan-as-unpaid"><a class="link" href="#marking-a-loan-as-unpaid">F.3.5. Marking a Loan as Unpaid</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Marking an existing loan as unpaid while all loans are listed</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: List all loans using the <code>loan list</code> command. At least one loan in the list that is paid.</p>
</li>
<li>
<p>Test case: <code>loan unpaid 1</code>
Expected: First loan is marked as unpaid. The "tick" icon should disappear from the left of the loan&#8217;s index.</p>
</li>
<li>
<p>Test case: <code>loan unpaid p/John</code>
Expected: All loans pertaining to the person "John" are marked as unpaid.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="deleting-a-loan"><a class="link" href="#deleting-a-loan">F.3.6. Deleting a Loan</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deleting an existing loan while all loans are listed</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: List all loans using the <code>loan list</code> command. At least one loan in the list.</p>
</li>
<li>
<p>Test case: <code>loan delete 1</code>
Expected: Deletes the first loan from the list.</p>
</li>
<li>
<p>Test case: <code>loan delete p/John</code>
Expected: All loans pertaining to the person "John" are deleted.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="splitting-a-payment-into-loans"><a class="link" href="#splitting-a-payment-into-loans">F.3.7. Splitting a Payment into Loans</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Splitting a group payment into loans/debts</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: None</p>
</li>
<li>
<p>Test case: <code>loan split p/John x/0 p/Mary x/10 p/Peter x/90</code>
Expected: Displays a list saying John owes Peter $3.33 and Mary owes Peter $23.33.</p>
</li>
<li>
<p>Test case: <code>loan split p/John x/0 max/10 p/Mary x/10 p/Peter x/30 p/Bruce x/90 p/Thomas x/50 me/John d/Big lunch</code>
Expected: Displays a list saying Mary owes Bruce $32.50, Peter owes Bruce $12.50,
and You owe Bruce and Thomas $2.50 and $7.50 respectively.
Two new loans out to Bruce and Thomas should be added to the normal loan list as well
(press <code>Ctrl + D</code> to switch between the two lists).</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rules"><a class="link" href="#rules">F.4. Rules</a></h3>
<div class="sect3">
<h4 id="listing-rules"><a class="link" href="#listing-rules">F.4.1. Listing rules</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Listing rules while another panel is shown</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: Display another panel using <code>account list</code>, <code>loan list</code>, <code>txn list</code>, or <code>script list</code>.</p>
</li>
<li>
<p>Test case: <code>rule list</code><br>
Expected: Current panel switches over to the rule panel and displays rule list.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Listing rules while on rule panel.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: Display the rule panel with with <code>rule list</code>.</p>
</li>
<li>
<p>Test case: <code>rule list</code><br>
Expected: Current panel remains on the rule panel, displays rule list.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="adding-a-rule"><a class="link" href="#adding-a-rule">F.4.2. Adding a rule</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adding a rule while on a different panel</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: Display another panel using <code>account list</code>, <code>loan list</code>, <code>txn list</code>, or <code>script list</code>.</p>
</li>
<li>
<p>Test case: <code>rule add p/desc = m a/set_desc Monthly Allowance</code>+
Expected: Rule is created, panel switches to rule panel.</p>
</li>
<li>
<p>Test case: <code>rule add p/it is monday a/prep_desc [Monday]</code>
Expected: No rule created. Error details shown in the status message.</p>
</li>
<li>
<p>Other incorrect rule add commands to try: <code>rule add a/set_in</code>, <code>rule add p/outamt &gt; 100</code><br>
Expected: Similar to previous.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Adding a rule while on the same panel</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Same test cases as above: e.g. <code>rule add p/desc = m a/set_desc Monthly Allowance</code>
Expected: Similar output as above, app remains on the rule panel.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="editing-a-rule"><a class="link" href="#editing-a-rule">F.4.3. Editing a rule</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Editing a rule on the same panel</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisite: At least 1 rule in the list.</p>
</li>
<li>
<p>Test case: <code>rule edit 1 p/date &lt; 11/11/2019</code>
Expected: Rule is edited and edited rule is shown on the rule list.</p>
</li>
<li>
<p>Test case: <code>rule edit 0 p/date &lt; 11/11/2019</code>
Expected: No rule edited. Error details shown in the status message.</p>
</li>
<li>
<p>Other incorrect rule edit commands to try: <code>rule edit 1</code>, <code>rule edit 1 p/outamt contains letters</code>, <code>rule edit 1 a/</code>
Expected: Similar to previous.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Editing a rule on a different panel</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: Display another panel using <code>account list</code>, <code>loan list</code>, <code>txn list</code>, or <code>script list</code>. At least 1 rule in the list.</p>
</li>
<li>
<p>Same test cases as above: e.g. <code>rule edit 1 p/date &lt; 11/11/2019</code>
Expected: Similar output as above, app switches over to the rule panel if rule is successfully edited.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="deleting-a-rule"><a class="link" href="#deleting-a-rule">F.4.4. Deleting a rule</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deleting a rule</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: More than 1 rule in the list</p>
</li>
<li>
<p>Test case: <code>rule delete 1</code>
Expected: Rule is deleted. If not on the rule panel, app switches to rule panel.</p>
</li>
<li>
<p>Test case: <code>rule delete 0</code>
Expected: No rule deleted. Error details shown in the status message.</p>
</li>
<li>
<p>Other incorrect delete commands to try: <code>rule delete</code>, <code>rule delete x</code> (where x is larger than the list size)<br>
Expected: Similar to previous.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="executing-rules"><a class="link" href="#executing-rules">F.4.5. Executing rules</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Rules are executed on newly added transaction</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Add rule: <code>rule add p/desc = m a/set_desc Monthly Allowance</code></p>
</li>
<li>
<p>Add rule: <code>rule add p/inamt &gt; 100 a/set_cat Large Savings</code></p>
</li>
</ol>
</div>
</li>
<li>
<p>Test case: <code>txn dn/in x/10 d/m</code>
Expected: Transaction is added. Transaction description seen in the transaction panel is "Monthly Allowance".</p>
</li>
<li>
<p>Test case: <code>txn dn/in x/100 d/m</code>
Expected: Similar to previous. Transaction also has a category "Large Savings"</p>
</li>
<li>
<p>Test case: <code>txn dn/out x/100 d/Buffet</code>
Expected: Transaction is added. Rules do not apply to transaction. No change to description or categories.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="scripts"><a class="link" href="#scripts">F.5. Scripts</a></h3>
<div class="sect3">
<h4 id="evaluating-an-expression"><a class="link" href="#evaluating-an-expression">F.5.1. Evaluating an expression</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Evaluating an expression</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: None</p>
</li>
<li>
<p>Test case: <code>script eval 123 + 456</code> Expected: "579" is shown in the command result box.</p>
</li>
<li>
<p>Test case: <code>script eval showAlert("Hello", "World")</code> Expected: An alert box with "Hello" as the title and "World" as the message is shown. "Script succeeded with no result." is shown in the command result box.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="listing-scripts"><a class="link" href="#listing-scripts">F.5.2. Listing scripts</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Listing scripts</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: A tab other than the script tab is active.</p>
</li>
<li>
<p>Test case: <code>script list</code> Expected: The script tab is activated.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="adding-a-script"><a class="link" href="#adding-a-script">F.5.3. Adding a script</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Adding a script from the command line</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: No script named <code>hello-world</code> exists.</p>
</li>
<li>
<p>Test case: <code>script add hello-world s/"Hello world"</code> Expected: The script tab is shown. "New script hello-world added." is shown in the command result box. A script <code>hello-world</code> with description "No description provided" is shown in the list of scripts.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Adding a script from file</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: No script named <code>hello-world</code> exists.</p>
</li>
<li>
<p>Test case: <code>script add hello-world</code> Expected: The script tab is shown. A file picker dialog appears. Once any file is selected, "New script hello-world added." is shown in the command result box. A script <code>hello-world</code> with description "No description provided" is shown in the list of scripts.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="running-a-script"><a class="link" href="#running-a-script">F.5.4. Running a script</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Running a script</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: <code>script add hello-world s/"Hello world"</code></p>
</li>
<li>
<p>Test case: <code>script run hello-world</code> Expected: "Hello world" is shown in the command result box.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="deleting-a-script"><a class="link" href="#deleting-a-script">F.5.5. Deleting a script</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Deleting a script</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: <code>script add hello-world s/"Hello world"</code></p>
</li>
<li>
<p>Test case: <code>script delete hello-world</code> Expected: The script tab is shown. "Script hello-world deleted." is shown in the command result box. No script with the name <code>hello-world</code> is listed in the list of scripts.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="resetting-the-scripting-environment"><a class="link" href="#resetting-the-scripting-environment">F.5.6. Resetting the scripting environment</a></h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Resetting the scripting environment</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Prerequisites: <code>script eval var a = 1</code></p>
</li>
<li>
<p>Test case: <code>script reset</code>, then <code>script eval a</code> Expected: "Exception while evaluating script: javax.script.ScriptException: ReferenceError: "a" is not defined in &lt;eval&gt; at line number 1" is shown in the command result box.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
</div></div><div id="footer"><div class="container"><div id="footer-text">Last updated 2019-11-11 15:15:51 UTC</div></div></div></body></html>